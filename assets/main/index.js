System.register("chunks:///_virtual/Card.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,e,r,n,s,o,a,l,u,c,p,S,h,m,d;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,r=t.initializerDefineProperty,n=t.assertThisInitialized,s=t.createForOfIteratorHelperLoose},function(t){o=t.cclegacy,a=t._decorator,l=t.Sprite,u=t.SpriteAtlas,c=t.SpriteFrame,p=t.Color,S=t.Vec3,h=t.tween,m=t.UITransform,d=t.Component}],execute:function(){var b,g,f,v,w,y,k,_,F,C,z,B,I;o._RF.push({},"e9ae8MoviNGnbXZ2ussE1Bx","Card",void 0);var A=a.ccclass,H=a.property;t("Card",(b=A("Card"),g=H({type:l,tooltip:"数字 Sprite"}),f=H({type:l,tooltip:"小花色 Sprite (左上角)"}),v=H({type:l,tooltip:"大花色 Sprite (中间图案)"}),w=H({type:u,tooltip:"扑克图集"}),y=H({type:c,tooltip:"【必拖】牌背图片"}),b((F=i((_=function(t){function i(){for(var i,e=arguments.length,s=new Array(e),o=0;o<e;o++)s[o]=arguments[o];return i=t.call.apply(t,[this].concat(s))||this,r(i,"numSprite",F,n(i)),r(i,"smallSuit",C,n(i)),r(i,"bigSuit",z,n(i)),r(i,"pokerAtlas",B,n(i)),r(i,"cardBackFrame",I,n(i)),i.isSelected=!1,i}e(i,t);var o=i.prototype;return o.start=function(){},o.showBack=function(){this.numSprite&&(this.numSprite.node.active=!1),this.smallSuit&&(this.smallSuit.node.active=!1),this.bigSuit&&(this.bigSuit.node.active=!1);var t=this.node.getComponent(l);t&&(t.node.active=!0,t.color=p.WHITE,this.cardBackFrame?t.spriteFrame=this.cardBackFrame:this.setSprite(t,"poker_back"))},o.setCard=function(t,i){if(this.numSprite&&(this.numSprite.node.active=!0),this.smallSuit&&(this.smallSuit.node.active=!0),this.bigSuit&&(this.bigSuit.node.active=!0),this.numSprite&&(this.numSprite.color=p.WHITE),this.smallSuit&&(this.smallSuit.color=p.WHITE),this.bigSuit&&(this.bigSuit.color=p.WHITE),this.setSprite(this.node.getComponent(l),"bg"),t>=13){var e=13==t||16==t,r=e?"smalltag_4":"smalltag_5";this.setSprite(this.smallSuit,r),this.smallSuit&&(this.smallSuit.node.setScale(new S(.7,.7,1)),this.smallSuit.node.setPosition(new S(-50,38,0)));var n=e?"bigtag_4":"bigtag_5";return this.setSprite(this.bigSuit,n),this.bigSuit&&(this.bigSuit.node.setPosition(new S(20,-30,0)),this.bigSuit.node.setScale(new S(.75,.75,1))),void(this.numSprite&&(this.numSprite.node.active=!1))}var s=[2,3,4,5,6,7,8,9,10,11,12,0,1][t],o=0===i||2===i?"red_":"black_";this.setSprite(this.numSprite,o+s);var a="bigtag_"+i;this.setSprite(this.smallSuit,a),this.smallSuit&&this.smallSuit.node.setScale(new S(.4,.4,1)),this.setSprite(this.bigSuit,a),this.bigSuit&&(this.bigSuit.node.setPosition(new S(10,-25,0)),this.bigSuit.node.setScale(new S(.9,.9,1)))},o.setSelectState=function(t,i){if(void 0===i&&(i=!1),this.isSelected!==t){this.isSelected=t;var e=this.isSelected?20:0,r=this.node.position.x;i?this.node.setPosition(new S(r,e,0)):h(this.node).stop().to(.1,{position:new S(r,e,0)}).start()}},o.getWidth=function(){var t=this.node.getComponent(m);return t?t.contentSize.width:0},o.setSprite=function(t,i){if(this.pokerAtlas&&t){for(var e,r=this.pokerAtlas.getSpriteFrames(),n=null,o=s(r);!(e=o()).done;){var a=e.value;if(a.name===i||a.name===i+".png"||a.name.endsWith("/"+i)){n=a;break}}n?(t.spriteFrame=n,t.node.active=!0):"poker_back"!==i||this.cardBackFrame||console.warn("Card: 找不到图片 "+i)}},i}(d)).prototype,"numSprite",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=i(_.prototype,"smallSuit",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=i(_.prototype,"bigSuit",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=i(_.prototype,"pokerAtlas",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=i(_.prototype,"cardBackFrame",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=_))||k));o._RF.pop()}}}));

System.register("chunks:///_virtual/DebugSize.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,o,i,r,s;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,o=e._decorator,i=e.view,r=e.UITransform,s=e.Component}],execute:function(){var u;n._RF.push({},"ed315+8vTRBm6rBea3OxwoI","DebugSize",void 0);var c=o.ccclass;o.property,e("DebugSize",c("DebugSize")(u=function(e){function n(){return e.apply(this,arguments)||this}return t(n,e),n.prototype.start=function(){var e=this;this.schedule((function(){var t=i.getVisibleSize(),n=e.node.parent.getComponent(r).width,o=e.node.getComponent(r).width;console.log("[真相侦探] \n            1. 屏幕可见宽度 (view): "+t.width.toFixed(0)+" (如果是1280就说明适配策略错了)\n            2. Canvas 节点宽度: "+n.toFixed(0)+"\n            3. Panel_Safe 宽度: "+o.toFixed(0))}),1)},n}(s))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/GameLogic.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var t,e,a;return{setters:[function(r){t=r.createForOfIteratorHelperLoose},function(r){e=r.cclegacy,a=r._decorator}],execute:function(){var i;e._RF.push({},"08963cVuXZFXaSL7RKDAxVE","GameLogic",void 0);var n=a.ccclass,l=r("CardType",function(r){return r[r.Invalid=0]="Invalid",r[r.Single=1]="Single",r[r.Pair=2]="Pair",r[r.Triple=3]="Triple",r[r.TripleWithOne=4]="TripleWithOne",r[r.TripleWithPair=5]="TripleWithPair",r[r.Straight=6]="Straight",r[r.StraightPairs=7]="StraightPairs",r[r.Plane=8]="Plane",r[r.FourWithOne=9]="FourWithOne",r[r.FourWithPair=10]="FourWithPair",r[r.Bomb=11]="Bomb",r[r.Rocket=12]="Rocket",r}({}));r("GameLogic",n("GameLogic")(i=function(){function r(){}return r.toLogicValue=function(r){return r<13?r+3:16===r?16:17===r?17:r},r.toRawValue=function(r){return r<=15?r-3:r},r.canBeat=function(r,t){return r.type!==l.Invalid&&(r.type===l.Rocket||t.type!==l.Rocket&&(r.type===l.Bomb?t.type!==l.Bomb||r.val>t.val:t.type!==l.Bomb&&(r.type===t.type&&(r.cards.length===t.cards.length&&r.val>t.val))))},r.analyzeCards=function(r){var e=r.length;if(0===e)return{type:l.Invalid,val:0,cards:r};r.sort((function(r,t){return t.val-r.val}));for(var a,i=new Map,n=t(r);!(a=n()).done;){var o=a.value;i.set(o.val,(i.get(o.val)||0)+1)}var c=0,u=0;if(i.forEach((function(r,t){r>c?(c=r,u=t):r===c&&t>u&&(u=t)})),2===e&&17===r[0].val&&16===r[1].val)return{type:l.Rocket,val:17,cards:r};if(4===e&&4===c)return{type:l.Bomb,val:u,cards:r};if(1===e)return{type:l.Single,val:r[0].val,cards:r};if(2===e&&2===c)return{type:l.Pair,val:u,cards:r};if(3===e&&3===c)return{type:l.Triple,val:u,cards:r};if(4===e&&3===c)return{type:l.TripleWithOne,val:u,cards:r};if(5===e&&3===c&&2===i.size)return{type:l.TripleWithPair,val:u,cards:r};if(6===e&&4===c)return{type:l.FourWithOne,val:u,cards:r};if(8===e&&4===c){var v=!1;if(i.forEach((function(r){r%2!=0&&(v=!0)})),!v)return{type:l.FourWithPair,val:u,cards:r}}if(e>=5&&1===c&&r[0].val<15){for(var f=!0,p=0;p<e-1;p++)if(r[p].val-r[p+1].val!=1){f=!1;break}if(f)return{type:l.Straight,val:r[0].val,cards:r}}if(e>=6&&e%2==0&&2===c&&i.size===e/2&&r[0].val<15){for(var s=Array.from(i.keys()).sort((function(r,t){return t-r})),h=!0,y=0;y<s.length-1;y++)if(s[y]-s[y+1]!=1){h=!1;break}if(h)return{type:l.StraightPairs,val:s[0],cards:r}}if(e>=6){var d=[];if(i.forEach((function(r,t){r>=3&&d.push(t)})),d.sort((function(r,t){return t-r})),d.length>=2){for(var g=0,P=0,m=1,W=0;W<d.length-1;W++)if(d[W]-d[W+1]==1&&d[W]<15?m++:m=1,m>=2){var S=e-3*m;0!==S&&S!==m&&S!==2*m||(g=m,P=d[W-(m-2)])}if(g>0)return{type:l.Plane,val:P,cards:r}}}return{type:l.Invalid,val:0,cards:r}},r}())||i);e._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Card.ts","./GameLogic.ts","./OpponentHand.ts","./SmartAI.ts"],(function(t){var e,i,n,l,r,a,s,o,h,u,c,p,d,b,f,y,g,_,v,m,C,S,w,T,P,R,M,B,D,E,H,z,A;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,l=t.assertThisInitialized,r=t.createForOfIteratorHelperLoose},function(t){a=t.cclegacy,s=t._decorator,o=t.Prefab,h=t.Node,u=t.ParticleSystem2D,c=t.Label,p=t.AudioSource,d=t.Toggle,b=t.AudioClip,f=t.view,y=t.input,g=t.Input,_=t.ResolutionPolicy,v=t.KeyCode,m=t.game,C=t.sys,S=t.instantiate,w=t.Vec3,T=t.UITransform,P=t.tween,R=t.Layout,M=t.Color,B=t.Component},function(t){D=t.Card},function(t){E=t.CardType,H=t.GameLogic},function(t){z=t.OpponentHand},function(t){A=t.SmartAI}],execute:function(){var L,G,k,O,I,N,x,U,F,W,V,X,K,Y,J,j,Q,Z,q,$,tt,et,it,nt,lt,rt,at,st,ot,ht,ut,ct,pt,dt,bt,ft,yt,gt,_t,vt,mt,Ct,St,wt,Tt,Pt,Rt,Mt,Bt,Dt,Et,Ht,zt,At,Lt,Gt,kt,Ot,It,Nt,xt,Ut,Ft,Wt,Vt,Xt,Kt,Yt,Jt,jt,Qt,Zt,qt,$t,te,ee,ie,ne,le,re,ae,se,oe,he,ue,ce,pe,de,be,fe,ye,ge,_e,ve,me,Ce,Se,we,Te,Pe,Re,Me,Be,De,Ee,He,ze,Ae,Le,Ge,ke,Oe,Ie,Ne,xe,Ue,Fe,We,Ve,Xe,Ke,Ye,Je,je,Qe,Ze,qe,$e,ti,ei,ii,ni,li,ri,ai,si,oi,hi,ui,ci,pi,di,bi,fi,yi,gi,_i,vi,mi,Ci,Si,wi,Ti,Pi,Ri,Mi,Bi;a._RF.push({},"00e4dQ48bRD0pWoymx8EV95","GameManager",void 0);var Di=s.ccclass,Ei=s.property,Hi=function(t){return t[t.Idle=0]="Idle",t[t.Deal=1]="Deal",t[t.Bid=2]="Bid",t[t.Double=3]="Double",t[t.Play=4]="Play",t[t.Settle=5]="Settle",t}(Hi||{});t("GameManager",(L=Di("GameManager"),G=Ei({type:o}),k=Ei({type:h}),O=Ei({type:h,tooltip:"我的出牌区 (中间)"}),I=Ei({type:h,tooltip:"左家出牌区 (左边)"}),N=Ei({type:h,tooltip:"右家出牌区 (右边)"}),x=Ei({type:h}),U=Ei({type:z}),F=Ei({type:z}),W=Ei({type:h}),V=Ei({type:h}),X=Ei({type:h}),K=Ei({type:h}),Y=Ei({type:h}),J=Ei({type:h}),j=Ei({type:h}),Q=Ei({type:h}),Z=Ei({type:h}),q=Ei({type:h}),$=Ei({type:h}),tt=Ei({type:h}),et=Ei({type:h}),it=Ei({type:h}),nt=Ei({type:h}),lt=Ei({type:u}),rt=Ei({type:c}),at=Ei({type:c}),st=Ei({type:c}),ot=Ei({type:c}),ht=Ei({type:h}),ut=Ei({type:h}),ct=Ei({type:p}),pt=Ei({type:h}),dt=Ei({type:c}),bt=Ei({type:c}),ft=Ei({type:c}),yt=Ei({type:c}),gt=Ei({type:c}),_t=Ei({type:c}),vt=Ei({type:c}),mt=Ei({type:c}),Ct=Ei({type:h}),St=Ei({type:h}),wt=Ei({type:h}),Tt=Ei({type:h}),Pt=Ei({type:h}),Rt=Ei({type:h}),Mt=Ei({type:d}),Bt=Ei({type:d}),Dt=Ei({type:b}),Et=Ei({type:b}),Ht=Ei({type:b}),zt=Ei({type:b}),At=Ei({type:b}),Lt=Ei({type:b}),Gt=Ei({type:b}),kt=Ei({type:b}),Ot=Ei({type:[b]}),It=Ei({type:[b]}),Nt=Ei({type:[b]}),xt=Ei({type:[b]}),Ut=Ei({type:[b]}),Ft=Ei({type:[b]}),Wt=Ei({type:[b]}),Vt=Ei({type:[b]}),Xt=Ei({type:[b]}),Kt=Ei({type:b}),Yt=Ei({type:b}),Jt=Ei({type:b}),jt=Ei({type:b}),Qt=Ei({type:b}),Zt=Ei({type:b}),qt=Ei({type:b}),$t=Ei({type:b}),te=Ei({type:b}),ee=Ei({type:[b]}),ie=Ei({type:[b]}),ne=Ei({type:[b]}),L((ae=e((re=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"cardPrefab",ae,l(e)),n(e,"meHolder",se,l(e)),n(e,"tableMe",oe,l(e)),n(e,"tableLeft",he,l(e)),n(e,"tableRight",ue,l(e)),n(e,"topHoleCardHolder",ce,l(e)),n(e,"leftPlayer",pe,l(e)),n(e,"rightPlayer",de,l(e)),n(e,"btnPlay",be,l(e)),n(e,"btnPass",fe,l(e)),n(e,"btnHint",ye,l(e)),n(e,"panelBid",ge,l(e)),n(e,"groupCall",_e,l(e)),n(e,"groupGrab",ve,l(e)),n(e,"groupDouble",me,l(e)),n(e,"btnCall",Ce,l(e)),n(e,"btnNoCall",Se,l(e)),n(e,"btnGrab",we,l(e)),n(e,"btnNoGrab",Te,l(e)),n(e,"btnDouble",Pe,l(e)),n(e,"btnNoDouble",Re,l(e)),n(e,"iconLandlord",Me,l(e)),n(e,"shakeRoot",Be,l(e)),n(e,"winParticle",De,l(e)),n(e,"lblMyScore",Ee,l(e)),n(e,"lblLeftScore",He,l(e)),n(e,"lblRightScore",ze,l(e)),n(e,"infoLabel",Ae,l(e)),n(e,"resultPanel",Le,l(e)),n(e,"btnRestart",Ge,l(e)),n(e,"audioSource",ke,l(e)),n(e,"panelResultNew",Oe,l(e)),n(e,"lblResTitle",Ie,l(e)),n(e,"lblResMeRole",Ne,l(e)),n(e,"lblResMeScore",xe,l(e)),n(e,"lblResLeftRole",Ue,l(e)),n(e,"lblResLeftScore",Fe,l(e)),n(e,"lblResRightRole",We,l(e)),n(e,"lblResRightScore",Ve,l(e)),n(e,"lblResMultiplier",Xe,l(e)),n(e,"btnContinue",Ke,l(e)),n(e,"panelAbout",Ye,l(e)),n(e,"btnCloseAbout",Je,l(e)),n(e,"btnInfo",je,l(e)),n(e,"panelSettings",Qe,l(e)),n(e,"btnSetting",Ze,l(e)),n(e,"toggleBGM",qe,l(e)),n(e,"toggleSFX",$e,l(e)),n(e,"clipBGMNormal",ti,l(e)),n(e,"clipBGMFast",ei,l(e)),n(e,"clipClick",ii,l(e)),n(e,"clipDeal",ni,l(e)),n(e,"clipWin",li,l(e)),n(e,"clipLose",ri,l(e)),n(e,"clipAlert1",ai,l(e)),n(e,"clipAlert2",si,l(e)),n(e,"clipsCall",oi,l(e)),n(e,"clipsNoCall",hi,l(e)),n(e,"clipsGrab",ui,l(e)),n(e,"clipsNoGrab",ci,l(e)),n(e,"clipsDouble",pi,l(e)),n(e,"clipsNoDouble",di,l(e)),n(e,"clipsPlay",bi,l(e)),n(e,"clipsPass",fi,l(e)),n(e,"clipsDani",yi,l(e)),n(e,"clipBomb",gi,l(e)),n(e,"clipRocket",_i,l(e)),n(e,"clipPlane",vi,l(e)),n(e,"clipStraight",mi,l(e)),n(e,"clipStraightPairs",Ci,l(e)),n(e,"clip31",Si,l(e)),n(e,"clip32",wi,l(e)),n(e,"clip4WithOne",Ti,l(e)),n(e,"clip4WithPair",Pi,l(e)),n(e,"clipsSingle",Ri,l(e)),n(e,"clipsPair",Mi,l(e)),n(e,"clipsTriple",Bi,l(e)),e._myHand=[],e._myCardScripts=[],e._lastPlayedCards=[],e._currentBoss="",e._landlord="",e._holeCards=[],e._isSliding=!1,e._startIdx=-1,e._currentIdx=-1,e._targetSelectState=!0,e._isActing=!1,e._hintMoves=[],e._hintIndex=0,e._baseScore=100,e._currentMultiple=1,e._scoreMe=1e4,e._scoreLeft=5e3,e._scoreRight=5e3,e._phase=Hi.Idle,e._bidTurnIndex=0,e._bidCount=0,e._hasLandlordCandidate=!1,e._landlordCandidate="",e._isFastBGM=!1,e._isBGMOn=!0,e._isSFXOn=!0,e.STORAGE_KEY_SCORE="yandra_ddz_release_v1",e._lastExitClickTime=0,e._firstBidder=0,e}i(e,t);var a=e.prototype;return a.start=function(){var t,e=this;this.adapt(),f.setResizeCallback((function(){e.adapt()})),this.meHolder&&(this.meHolder.on(h.EventType.TOUCH_START,this.onTouchStart,this),this.meHolder.on(h.EventType.TOUCH_MOVE,this.onTouchMove,this),this.meHolder.on(h.EventType.TOUCH_END,this.onTouchEnd,this),this.meHolder.on(h.EventType.TOUCH_CANCEL,this.onTouchEnd,this)),this.btnPlay&&this.btnPlay.on(h.EventType.TOUCH_END,this.onPlayBtnClicked,this),this.btnPass&&this.btnPass.on(h.EventType.TOUCH_END,this.onPassBtnClicked,this),this.btnRestart&&this.btnRestart.on(h.EventType.TOUCH_END,this.initGame,this),this.btnCall&&this.btnCall.on(h.EventType.TOUCH_END,(function(){return e.onUserBtnClick(!0)}),this),this.btnGrab&&this.btnGrab.on(h.EventType.TOUCH_END,(function(){return e.onUserBtnClick(!0)}),this),this.btnDouble&&this.btnDouble.on(h.EventType.TOUCH_END,(function(){return e.onUserBtnClick(!0)}),this),this.btnNoCall&&this.btnNoCall.on(h.EventType.TOUCH_END,(function(){return e.onUserBtnClick(!1)}),this),this.btnNoGrab&&this.btnNoGrab.on(h.EventType.TOUCH_END,(function(){return e.onUserBtnClick(!1)}),this),this.btnNoDouble&&this.btnNoDouble.on(h.EventType.TOUCH_END,(function(){return e.onUserBtnClick(!1)}),this),this.btnHint&&(this.btnHint.off(h.EventType.TOUCH_END),this.btnHint.on(h.EventType.TOUCH_END,this.onHintClicked,this)),this.btnContinue&&this.btnContinue.on(h.EventType.TOUCH_END,this.initGame,this),this.btnInfo&&this.btnInfo.on(h.EventType.TOUCH_END,this.onBtnInfoClick,this),this.btnSetting&&this.btnSetting.on(h.EventType.TOUCH_END,this.onBtnSettingClick,this),this.toggleBGM&&this.toggleBGM.node.on("toggle",this.onAudioSettingsChanged,this),this.toggleSFX&&this.toggleSFX.node.on("toggle",this.onAudioSettingsChanged,this),this.panelAbout&&this.panelAbout.on(h.EventType.TOUCH_END,(function(){e.panelAbout.active=!1}),this),this.btnCloseAbout&&this.btnCloseAbout.on(h.EventType.TOUCH_END,(function(){e.playEffect(e.clipClick),e.panelAbout.active=!1}),this),this.panelSettings&&(null==(t=this.panelSettings.getChildByName("BtnClose"))||t.on(h.EventType.TOUCH_END,(function(){e.panelSettings.active=!1}),this)),y.on(g.EventType.KEY_DOWN,this.onKeyDown,this),this.loadGameData(),this.scheduleOnce((function(){return e.initGame()}),.5)},a.adapt=function(){var t=f.getVisibleSize();t.width/t.height<1.7?f.setDesignResolutionSize(1280,720,_.FIXED_WIDTH):f.setDesignResolutionSize(1280,720,_.FIXED_HEIGHT)},a.onDestroy=function(){y.off(g.EventType.KEY_DOWN,this.onKeyDown,this)},a.onKeyDown=function(t){if(t.keyCode===v.MOBILE_BACK){if(this.panelSettings&&this.panelSettings.active)return void(this.panelSettings.active=!1);if(this.panelAbout&&this.panelAbout.active)return void(this.panelAbout.active=!1);if(this.panelResultNew&&this.panelResultNew.active)return void this.initGame();var e=Date.now();e-this._lastExitClickTime<2e3?m.end():(this._lastExitClickTime=e,this.showDebugTip("再按一次退出游戏"))}},a.loadGameData=function(){var t=C.localStorage.getItem(this.STORAGE_KEY_SCORE);if(t)try{var e=JSON.parse(t);e&&(this._scoreMe="number"==typeof e.me?e.me:1e4,this._scoreLeft="number"==typeof e.left?e.left:5e3,this._scoreRight="number"==typeof e.right?e.right:5e3)}catch(t){}this._scoreMe<500&&(this._scoreMe=3e3,this.showDebugTip("欢迎回来！系统赠送 3000 救济金！"),this.saveGameData())},a.saveGameData=function(){var t={me:this._scoreMe,left:this._scoreLeft,right:this._scoreRight};C.localStorage.setItem(this.STORAGE_KEY_SCORE,JSON.stringify(t))},a.onBtnInfoClick=function(){this.playEffect(this.clipClick),this.panelAbout&&(this.panelAbout.active=!0)},a.onBtnSettingClick=function(){this.playEffect(this.clipClick),this.panelSettings&&(this.panelSettings.active=!0)},a.onAudioSettingsChanged=function(){this.toggleBGM&&(this._isBGMOn=this.toggleBGM.isChecked),this.toggleSFX&&(this._isSFXOn=this.toggleSFX.isChecked),this._isBGMOn?this.audioSource&&!this.audioSource.playing&&this.playBGM(this._isFastBGM):this.audioSource&&this.audioSource.stop()},a.playBGM=function(t){if(this.audioSource&&this._isBGMOn){var e=t?this.clipBGMFast:this.clipBGMNormal;e||(e=this.clipBGMNormal),this.audioSource.clip===e&&this.audioSource.playing||(this.audioSource.stop(),this.audioSource.clip=e,this.audioSource.loop=!0,this.audioSource.play(),this._isFastBGM=t)}},a.checkBGM=function(){if(this._phase===Hi.Play){var t=this._myHand.length,e=this.leftPlayer?this.leftPlayer.getCardCount():17,i=this.rightPlayer?this.rightPlayer.getCardCount():17;t<=2||e<=2||i<=2?this.playBGM(!0):this.playBGM(!1)}},a.playEffect=function(t){this.audioSource&&t&&this._isSFXOn&&this.audioSource.playOneShot(t)},a.playRandomEffect=function(t){if(this.audioSource&&t&&0!==t.length&&this._isSFXOn){var e=Math.floor(Math.random()*t.length);t[e]&&this.audioSource.playOneShot(t[e])}},a.playCardSound=function(t,e){if(this.playRandomEffect(this.clipsPlay),!e&&t.type!==E.Bomb&&t.type!==E.Rocket&&Math.random()>.6)this.playRandomEffect(this.clipsDani);else switch(t.type){case E.Single:this.clipsSingle[t.val-3]&&this.playEffect(this.clipsSingle[t.val-3]);break;case E.Pair:this.clipsPair[t.val-3]&&this.playEffect(this.clipsPair[t.val-3]);break;case E.Triple:this.clipsTriple[t.val-3]?this.playEffect(this.clipsTriple[t.val-3]):this.playEffect(this.clip31);break;case E.TripleWithOne:this.playEffect(this.clip31);break;case E.TripleWithPair:this.playEffect(this.clip32);break;case E.Straight:this.playEffect(this.clipStraight);break;case E.StraightPairs:this.playEffect(this.clipStraightPairs);break;case E.Plane:this.playEffect(this.clipPlane);break;case E.Bomb:this.playEffect(this.clipBomb);break;case E.Rocket:this.playEffect(this.clipRocket);break;case E.FourWithOne:this.playEffect(this.clip4WithOne);break;case E.FourWithPair:this.playEffect(this.clip4WithPair)}},a.initGame=function(){var t,e,i,n,l,r=this;console.log("游戏重置"),this.unscheduleAllCallbacks(),this._phase=Hi.Idle,this.resultPanel&&(this.resultPanel.active=!1),this.panelResultNew&&(this.panelResultNew.active=!1),this.panelBid&&(this.panelBid.active=!1),this.hideAllGroups(),this.iconLandlord&&(this.iconLandlord.active=!1),this.btnHint&&(this.btnHint.active=!1),this.winParticle&&(this.winParticle.stopSystem(),this.winParticle.node.active=!1),null==(t=this.topHoleCardHolder)||t.removeAllChildren(),null==(e=this.meHolder)||e.removeAllChildren(),null==(i=this.tableMe)||i.removeAllChildren(),null==(n=this.tableLeft)||n.removeAllChildren(),null==(l=this.tableRight)||l.removeAllChildren(),this.playBGM(!1),this._isActing=!0,this._currentMultiple=1,this.updateScoreLabels(),this._lastPlayedCards=[],this._currentBoss="",this._landlord="",this._myCardScripts=[],this._hintMoves=[],this._hintIndex=0;for(var a=[],s=0;s<=12;s++)for(var o=0;o<=3;o++)a.push({val:H.toLogicValue(s),suit:o,index:0});a.push({val:16,suit:0,index:0}),a.push({val:17,suit:1,index:0}),a.sort((function(){return Math.random()-.5})),this._holeCards=a.slice(0,3);var h=a.slice(3);this.renderHoleCards(!1),this._myHand=h.slice(0,17),this._myHand.sort((function(t,e){return e.val-t.val})),this.leftPlayer&&this.leftPlayer.setCards(h.slice(17,34),!0),this.rightPlayer&&this.rightPlayer.setCards(h.slice(34,51),!0),this.showDebugTip("正在发牌..."),this._phase=Hi.Deal,this.animateDeal(this._myHand,(function(){r.startBiddingLogic()}))},a.hideAllGroups=function(){this.groupCall&&(this.groupCall.active=!1),this.groupGrab&&(this.groupGrab.active=!1),this.groupDouble&&(this.groupDouble.active=!1)},a.startBiddingLogic=function(){this._phase=Hi.Bid,this._bidCount=0,this._hasLandlordCandidate=!1,this._landlordCandidate="",this._firstBidder=Math.floor(3*Math.random()),this._bidTurnIndex=this._firstBidder,this.showDebugTip(this.getSeatName(this._bidTurnIndex)+" 开始叫牌"),this.processBidTurn()},a.getSeatName=function(t){return 0===t?"我":1===t?"右家":"左家"},a.processBidTurn=function(){var t=this;this._bidCount>=3?this.finishBidding():0===this._bidTurnIndex?this.showMyBidPanel():this.scheduleOnce((function(){t.aiBidAction()}),1)},a.showMyBidPanel=function(){this.panelBid&&(this.panelBid.active=!0,this.hideAllGroups(),this._phase===Hi.Bid?this._hasLandlordCandidate?this.groupGrab&&(this.groupGrab.active=!0):this.groupCall&&(this.groupCall.active=!0):this._phase===Hi.Double&&this.groupDouble&&(this.groupDouble.active=!0))},a.onUserBtnClick=function(t){var e=this;this.panelBid.active=!1,this.playEffect(this.clipClick),this._phase===Hi.Bid?(t?(this._hasLandlordCandidate?(this.showDebugTip("我方抢地主"),this.playRandomEffect(this.clipsGrab),this._currentMultiple*=2):(this.showDebugTip("我方叫地主"),this.playRandomEffect(this.clipsCall)),this._hasLandlordCandidate=!0,this._landlordCandidate="me"):this._hasLandlordCandidate?(this.showDebugTip("我方不抢"),this.playRandomEffect(this.clipsNoGrab)):(this.showDebugTip("我方不叫"),this.playRandomEffect(this.clipsNoCall)),this.nextBidder()):this._phase===Hi.Double&&(t?(this._currentMultiple*=2,this.showDebugTip("我方加倍"),this.playRandomEffect(this.clipsDouble)):(this.showDebugTip("我方不加倍"),this.playRandomEffect(this.clipsNoDouble)),this.scheduleOnce((function(){return e.startGameplay()}),.5))},a.aiBidAction=function(){var t=Math.random()>.5,e=1===this._bidTurnIndex?"right":"left",i="right"===e?"右家":"左家";t?(this._hasLandlordCandidate?(this.showDebugTip(i+" 抢地主"),this.playRandomEffect(this.clipsGrab),this._currentMultiple*=2):(this.showDebugTip(i+" 叫地主"),this.playRandomEffect(this.clipsCall)),this._hasLandlordCandidate=!0,this._landlordCandidate=e):this._hasLandlordCandidate?(this.showDebugTip(i+" 不抢"),this.playRandomEffect(this.clipsNoGrab)):(this.showDebugTip(i+" 不叫"),this.playRandomEffect(this.clipsNoCall)),this.nextBidder()},a.nextBidder=function(){this._bidCount++,this._bidTurnIndex=(this._bidTurnIndex+1)%3,this.processBidTurn()},a.finishBidding=function(){var t=this;if(!this._landlordCandidate)return this.showDebugTip("无人叫地主，重新发牌..."),void this.scheduleOnce((function(){return t.initGame()}),1.5);this.setLandlord(this._landlordCandidate)},a.setLandlord=function(t){var e;(this._landlord=t,this.showDebugTip("地主身份确认："+("me"===t?"我方":t)),this.renderHoleCards(!0),"me"===t)?((e=this._myHand).push.apply(e,this._holeCards),this._myHand.sort((function(t,e){return e.val-t.val})),this.renderMyHand()):"left"===t?this.leftPlayer.addCards(this._holeCards):"right"===t&&this.rightPlayer.addCards(this._holeCards);this.updateLandlordIcon(t),this.startDoublingPhase()},a.startDoublingPhase=function(){this._phase=Hi.Double,this.showDebugTip("请选择是否加倍"),this.showMyBidPanel()},a.startGameplay=function(){this._phase=Hi.Play,this.checkBGM(),"me"===this._landlord?(this._currentBoss="me",this.startMyTurn()):this.opponentAction(this._landlord)},a.renderHoleCards=function(t){if(this.topHoleCardHolder){this.topHoleCardHolder.removeAllChildren();for(var e=0;e<this._holeCards.length;e++){var i=this._holeCards[e],n=S(this.cardPrefab);n.parent=this.topHoleCardHolder,n.setScale(.4,.4,1),n.setPosition(40*e-40,0,0);var l=n.getComponent(D);l&&(l.setCard(H.toRawValue(i.val),i.suit),t||l.showBack())}}},a.updateLandlordIcon=function(t){if(this.iconLandlord){this.iconLandlord.active=!0;var e=null,i=new w(0,0,0);"me"===t?(e=this.meHolder,i=new w(0,150,0)):"left"===t?(e=this.leftPlayer?this.leftPlayer.node:null,i=new w(80,50,0)):"right"===t&&(e=this.rightPlayer?this.rightPlayer.node:null,i=new w(-80,50,0));var n=new w(0,0,0);if(e&&this.iconLandlord.parent){var l=e.getComponent(T).convertToWorldSpaceAR(w.ZERO);(n=this.iconLandlord.parent.getComponent(T).convertToNodeSpaceAR(l)).add(i)}else"me"===t&&(n=new w(-426,-46,0)),"left"===t&&(n=new w(-275,278,0)),"right"===t&&(n=new w(592,220,0));P(this.iconLandlord).to(.5,{position:n,scale:new w(1,1,1)},{easing:"backOut"}).start()}},a.updateScoreLabels=function(){this.lblMyScore&&(this.lblMyScore.string=""+this._scoreMe),this.lblLeftScore&&(this.lblLeftScore.string=""+this._scoreLeft),this.lblRightScore&&(this.lblRightScore.string=""+this._scoreRight)},a.startMyTurn=function(){var t,e,i;(this._isActing=!1,this._hintMoves=[],this._hintIndex=0,"me"===this._currentBoss)&&(this._lastPlayedCards=[],null==(t=this.tableMe)||t.removeAllChildren(),null==(e=this.tableLeft)||e.removeAllChildren(),null==(i=this.tableRight)||i.removeAllChildren(),this.showDebugTip("当前轮到我方任意出牌"));this.btnPlay&&(this.btnPlay.active=!0),this.btnPass&&(this.btnPass.active=this._lastPlayedCards.length>0&&"me"!==this._currentBoss),this.btnHint&&(this.btnHint.active=this._lastPlayedCards.length>0&&"me"!==this._currentBoss)},a.animateDeal=function(t,e){var i=this,n=0;this.schedule((function(){if(n>=t.length)e&&e();else{var l=t[n];i.createOneCard(l),i.playEffect(i.clipDeal),n++}}),.04,t.length)},a.createOneCard=function(t){if(this.meHolder){var e=S(this.cardPrefab);e.parent=this.meHolder,e.setPosition(0,0,0),e.setScale(1,1,1);var i=e.getComponent(D);i&&(i.setCard(H.toRawValue(t.val),t.suit),i.setSelectState(!1,!0),this._myCardScripts.push(i))}},a.onHintClicked=function(){if(!this._isActing){if(0===this._hintMoves.length){var t=E.Invalid,e=0;if(this._lastPlayedCards.length>0&&"me"!==this._currentBoss){var i=H.analyzeCards(this._lastPlayedCards);t=i.type,e=i.val}this._hintMoves=A.findAllMoves(this._myHand,t,e),this._hintIndex=0}if(0!==this._hintMoves.length){var n=this._hintMoves[this._hintIndex];this._myCardScripts.forEach((function(t){return t.setSelectState(!1)}));for(var l=0;l<this._myHand.length;l++){for(var a,s=this._myHand[l],o=!1,h=r(n);!(a=h()).done;){var u=a.value;if(u.val===s.val&&u.suit===s.suit){o=!0;break}}o&&this._myCardScripts[l].setSelectState(!0)}this._hintIndex=(this._hintIndex+1)%this._hintMoves.length,this.playEffect(this.clipClick)}else this.showDebugTip("提示：没有可压制的牌型")}},a.onPlayBtnClicked=function(){var t=this;if(!this._isActing){for(var e=[],i=[],n=[],l=0;l<this._myCardScripts.length;l++)this._myCardScripts[l].isSelected&&(e.push(this._myHand[l]),n.push(this._myCardScripts[l].node.worldPosition.clone()));if(0!==e.length){e.sort((function(t,e){return t.val-e.val}));var a=H.analyzeCards(e);if(a.type===E.Invalid){var s=this._tryFixSelection(e);s&&(e=s,a=H.analyzeCards(e))}if(a.type!==E.Invalid){var o="me"===this._currentBoss||0===this._lastPlayedCards.length;if(!o){var h=H.analyzeCards(this._lastPlayedCards);if(!H.canBeat(a,h))return void this.showDebugTip("牌型小于上家，无法出牌")}a.type===E.Bomb&&(this._currentMultiple*=2,this.showDebugTip("炸弹！当前倍数 x"+this._currentMultiple),this.shakeScreen(.5,15)),a.type===E.Rocket&&(this._currentMultiple*=2,this.showDebugTip("王炸！当前倍数 x"+this._currentMultiple),this.shakeScreen(.8,30)),this._isActing=!0,this.playCardSound(a,o),i=[];for(var u,c=[].concat(e),p=r(this._myHand);!(u=p()).done;){for(var d=u.value,b=-1,f=0;f<c.length;f++)if(c[f].val===d.val&&c[f].suit===d.suit){b=f;break}-1!==b?c.splice(b,1):i.push(d)}this._myHand=i,this._lastPlayedCards=e,this._currentBoss="me",this.renderMyHand(),this.displayTableCards(e,"me",n),this.btnPlay&&(this.btnPlay.active=!1),this.btnPass&&(this.btnPass.active=!1),this.btnHint&&(this.btnHint.active=!1),2===this._myHand.length?this.playEffect(this.clipAlert2):1===this._myHand.length&&this.playEffect(this.clipAlert1),this.checkBGM(),0!==this._myHand.length?this.scheduleOnce((function(){return t.opponentAction("right")}),1):this.scheduleOnce((function(){return t.showResult("me")}),1)}else this.showDebugTip("牌型不符合规则")}else this.showDebugTip("请选择要出的牌")}},a.onPassBtnClicked=function(){var t=this;this._isActing||(this.showDebugTip("不出"),this.playRandomEffect(this.clipsPass),this._isActing=!0,this.tableMe&&this.tableMe.removeAllChildren(),this.btnPlay&&(this.btnPlay.active=!1),this.btnPass&&(this.btnPass.active=!1),this.btnHint&&(this.btnHint.active=!1),this.scheduleOnce((function(){return t.opponentAction("right")}),.5))},a.opponentAction=function(t){var e=this,i="right"===t?this.rightPlayer:this.leftPlayer,n="right"===t?"left":"me",l="right"===t?"右边":"左边";if(i){var r,a,s;if(this._currentBoss===t)null==(r=this.tableMe)||r.removeAllChildren(),null==(a=this.tableLeft)||a.removeAllChildren(),null==(s=this.tableRight)||s.removeAllChildren();var o=this._currentBoss===t?[]:this._lastPlayedCards,h=this._landlord===t?1:0,u=-1;u=this._currentBoss===t||""===this._currentBoss?-1:"me"===this._currentBoss?"me"===this._landlord?1:0:"left"===this._currentBoss?"left"===this._landlord?1:0:"right"===this._landlord?1:0;var c=!1;"left"===t?c="me"===this._landlord:"right"===t&&(c="left"===this._landlord);var p=0;p="me"===this._landlord?this._myHand.length:"left"===this._landlord?this.leftPlayer.getCardCount():this.rightPlayer.getCardCount();var d={myRole:h,lastRole:u,lastHandCount:o.length>0?this._getLastHandCount():0,myHandCount:i.getCardCount(),landlordHandCount:p,isLandlordNext:c};i.startTurn(o,d,(function(r){if(r.length>0){var a=H.analyzeCards(r);e.playCardSound(a,e._currentBoss===t),a.type===E.Bomb&&(e._currentMultiple*=2,e.showDebugTip(l+" 打出炸弹，当前倍数 x"+e._currentMultiple),e.shakeScreen(.5,15)),a.type===E.Rocket&&(e._currentMultiple*=2,e.showDebugTip(l+" 打出王炸，当前倍数 x"+e._currentMultiple),e.shakeScreen(.8,30)),e._lastPlayedCards=r,e._currentBoss=t,e.showDebugTip(l+" 出牌");var s=i.node.worldPosition.clone();if(e.displayTableCards(r,t,null,s),2===i.getCardCount()?e.playEffect(e.clipAlert2):1===i.getCardCount()&&e.playEffect(e.clipAlert1),e.checkBGM(),0===i.getCardCount())return void e.scheduleOnce((function(){return e.showResult(t)}),1)}else e.showDebugTip(l+" 不出"),e.playRandomEffect(e.clipsPass),"left"===t&&e.tableLeft&&e.tableLeft.removeAllChildren(),"right"===t&&e.tableRight&&e.tableRight.removeAllChildren();"me"===n?e.startMyTurn():e.opponentAction(n)}))}},a._getLastHandCount=function(){return"me"===this._currentBoss?this._myHand.length:"left"===this._currentBoss?this.leftPlayer.getCardCount():"right"===this._currentBoss?this.rightPlayer.getCardCount():0},a.displayTableCards=function(t,e,i,n){void 0===i&&(i=null),void 0===n&&(n=null);var l=null;if(l="me"===e?this.tableMe:"left"===e?this.tableLeft:this.tableRight){l.removeAllChildren();var r=l.getComponent(R);r&&(r.enabled=!1),t.sort((function(t,e){return e.val-t.val}));for(var a=t.length>10?25:35,s=-((t.length-1)*a)/2,o=0;o<t.length;o++){var h=t[o],u=S(this.cardPrefab);u.parent=l,u.getComponent(D).setCard(H.toRawValue(h.val),h.suit);var c=new w(s+o*a,0,0),p=new w(0,0,0);p="me"===e&&i&&i[o]?l.getComponent(T).convertToNodeSpaceAR(i[o]):"me"!==e&&n?l.getComponent(T).convertToNodeSpaceAR(n):c.clone(),u.setPosition(p),u.setScale(.3,.3,1),P(u).parallel(P().to(.3,{position:c},{easing:"cubicOut"}),P().to(.3,{scale:new w(.55,.55,1)},{easing:"backOut"})).start()}}},a.renderMyHand=function(){var t;null==(t=this.meHolder)||t.removeAllChildren(),this._myCardScripts=[],this._myHand.sort((function(t,e){return e.val-t.val}));for(var e,i=r(this._myHand);!(e=i()).done;){var n=e.value;this.createOneCard(n)}},a.showResult=function(t){var e=this;this.unscheduleAllCallbacks(),this.audioSource&&this.audioSource.stop();var i=t===this._landlord,n=i===("me"===this._landlord);this.playEffect(n?this.clipWin:this.clipLose),n&&this.winParticle?(this.winParticle.node.active=!0,this.winParticle.resetSystem()):this.winParticle&&(this.winParticle.stopSystem(),this.winParticle.node.active=!1);var l=this._baseScore*this._currentMultiple,r=0,a=0,s=0;if(i?"me"===this._landlord?(r=2*l,a=-l,s=-l):"left"===this._landlord?(a=2*l,r=-l,s=-l):"right"===this._landlord&&(s=2*l,r=-l,a=-l):"me"===this._landlord?(r=2*-l,a=l,s=l):"left"===this._landlord?(a=2*-l,r=l,s=l):"right"===this._landlord&&(s=2*-l,r=l,a=l),this._scoreMe+=r,this._scoreLeft+=a,this._scoreRight+=s,this._scoreMe<0&&(this._scoreMe=0),this._scoreLeft<0&&(this._scoreLeft=0,this.scheduleOnce((function(){e._scoreLeft+=5e3}),1.5)),this._scoreRight<0&&(this._scoreRight=0,this.scheduleOnce((function(){e._scoreRight+=5e3}),1.5)),0===this._scoreMe&&this.scheduleOnce((function(){e._scoreMe=3e3,e.showDebugTip("破产了？别灰心！系统赠送 3000 救济金！"),e.updateScoreLabels(),e.saveGameData()}),1.5),this.updateScoreLabels(),this.saveGameData(),this.panelResultNew){this.panelResultNew.active=!0,this.lblResTitle&&(this.lblResTitle.string=n?"胜 利":"失 败",this.lblResTitle.color=n?new M(255,215,0):new M(0,0,0)),this.lblResMultiplier&&(this.lblResMultiplier.string="x "+this._currentMultiple);var o=function(t,i,n){var l=n===e._landlord?"地主":"农民",o=0;o="me"===n?r:"left"===n?a:s,t&&(t.string=l),i&&(i.string=(o>0?"+":"")+o,i.color=o>0?M.YELLOW:M.WHITE)};o(this.lblResMeRole,this.lblResMeScore,"me"),o(this.lblResLeftRole,this.lblResLeftScore,"left"),o(this.lblResRightRole,this.lblResRightScore,"right")}},a.showDebugTip=function(t){this.infoLabel&&(this.infoLabel.string=t,this.infoLabel.node.active=!0,this.unschedule(this.hideTip),this.scheduleOnce(this.hideTip,2))},a.hideTip=function(){this.infoLabel&&this.infoLabel.isValid&&(this.infoLabel.node.active=!1)},a.onTouchStart=function(t){if(this._phase!==Hi.Deal&&this._phase!==Hi.Settle){var e=this.getCardIndexByPos(t.getUILocation());-1!==e&&(this.playEffect(this.clipClick),this._isSliding=!0,this._startIdx=e,this._currentIdx=e,this._targetSelectState=!this._myCardScripts[e].isSelected,this.updateSelectionVisual())}},a.shakeScreen=function(t,e){void 0===e&&(e=20);var i=this.shakeRoot||this.node,n=i.position.clone();P(i).to(.05,{position:new w(n.x+e,n.y+e,0)}).to(.05,{position:new w(n.x-e,n.y-e,0)}).to(.05,{position:new w(n.x+.8*e,n.y-.8*e,0)}).to(.05,{position:new w(n.x-.8*e,n.y+.8*e,0)}).to(.05,{position:n}).start()},a.onTouchMove=function(t){if(this._isSliding){var e=this.getCardIndexByPos(t.getUILocation());-1!==e&&e!==this._currentIdx&&(this._currentIdx=e,this.updateSelectionVisual())}},a.onTouchEnd=function(t){this._isSliding=!1,this._targetSelectState&&this._smartCorrectSelection()},a._smartCorrectSelection=function(){var t=this;if(-1!==this._startIdx&&-1!==this._currentIdx){var e=Math.min(this._startIdx,this._currentIdx),i=Math.max(this._startIdx,this._currentIdx);if(e!==i){for(var n=[],l=e;l<=i;l++)n.push({index:l,val:this._myHand[l].val});var a=n.map((function(e){return t._myHand[e.index]}));if(a.sort((function(t,e){return t.val-e.val})),H.analyzeCards(a).type===E.Invalid){n.sort((function(t,e){return t.val-e.val}));var s=[],o=this._scanForStraight(n),h=this._scanForPairs(n);if(h.length>=6&&h.length>s.length&&(s=h),o.length>=5&&o.length>s.length&&(s=o),s.length>0){for(var u=e;u<=i;u++)this._myCardScripts[u].setSelectState(!1);for(var c,p=r(s);!(c=p()).done;){var d=c.value;this._myCardScripts[d].setSelectState(!0)}}else for(var b=e;b<=i;b++)this._myCardScripts[b].setSelectState(!0)}else for(var f=e;f<=i;f++)this._myCardScripts[f].setSelectState(!0)}}},a._scanForStraight=function(t){if(t.length<5)return[];var e=t.filter((function(t){return t.val<15}));if(e.length<5)return[];for(var i,n=new Map,l=r(e);!(i=l()).done;){var a=i.value;n.has(a.val)||n.set(a.val,[]),n.get(a.val).push(a.index)}for(var s=Array.from(n.keys()).sort((function(t,e){return t-e})),o=[],h=[],u=0;u<s.length;u++){var c=s[u];0===h.length||c===h[h.length-1]+1?h.push(c):(h.length>o.length&&(o=[].concat(h)),h=[c])}if(h.length>o.length&&(o=[].concat(h)),o.length>=5){for(var p,d=[],b=r(o);!(p=b()).done;){var f=p.value;d.push(n.get(f)[0])}return d}return[]},a._scanForPairs=function(t){var e=t.filter((function(t){return t.val<15}));if(e.length<6)return[];for(var i,n=new Map,l=r(e);!(i=l()).done;){var a=i.value;n.has(a.val)||n.set(a.val,[]),n.get(a.val).push(a.index)}var s=Array.from(n.keys()).filter((function(t){return n.get(t).length>=2})).sort((function(t,e){return t-e}));if(s.length<3)return[];for(var o,h=[],u=[],c=r(s);!(o=c()).done;){var p=o.value;0===u.length||p===u[u.length-1]+1?u.push(p):(u.length>h.length&&(h=[].concat(u)),u=[p])}if(u.length>h.length&&(h=[].concat(u)),h.length>=3){for(var d,b=[],f=r(h);!(d=f()).done;){var y=d.value;b.push(n.get(y)[0]),b.push(n.get(y)[1])}return b}return[]},a._tryFixSelection=function(t){for(var e,i=new Map,n=r(t);!(e=n()).done;){var l=e.value;i.has(l.val)||i.set(l.val,[]),i.get(l.val).push(l)}var a=Array.from(i.keys()).sort((function(t,e){return t-e}));if(a.length<3)return null;for(var s,o=[],h=r(a);!(s=h()).done;){var u=s.value,c=i.get(u);if(c.length<2)return null;o.push(c[0]),o.push(c[1])}return o.sort((function(t,e){return t.val-e.val})),H.analyzeCards(o).type!==E.Invalid?o:null},a.updateSelectionVisual=function(){for(var t=Math.min(this._startIdx,this._currentIdx),e=Math.max(this._startIdx,this._currentIdx),i=t;i<=e;i++)this._myCardScripts[i]&&this._myCardScripts[i].setSelectState(this._targetSelectState)},a.getCardIndexByPos=function(t){if(!this.meHolder)return-1;for(var e=this._myCardScripts.length-1;e>=0;e--){var i=this._myCardScripts[e].node.getComponent(T);if(i&&i.isHit(t))return e}return-1},e}(B)).prototype,"cardPrefab",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),se=e(re.prototype,"meHolder",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oe=e(re.prototype,"tableMe",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),he=e(re.prototype,"tableLeft",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ue=e(re.prototype,"tableRight",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=e(re.prototype,"topHoleCardHolder",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pe=e(re.prototype,"leftPlayer",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),de=e(re.prototype,"rightPlayer",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),be=e(re.prototype,"btnPlay",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fe=e(re.prototype,"btnPass",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ye=e(re.prototype,"btnHint",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ge=e(re.prototype,"panelBid",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_e=e(re.prototype,"groupCall",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ve=e(re.prototype,"groupGrab",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),me=e(re.prototype,"groupDouble",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ce=e(re.prototype,"btnCall",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Se=e(re.prototype,"btnNoCall",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),we=e(re.prototype,"btnGrab",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Te=e(re.prototype,"btnNoGrab",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pe=e(re.prototype,"btnDouble",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Re=e(re.prototype,"btnNoDouble",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Me=e(re.prototype,"iconLandlord",[it],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Be=e(re.prototype,"shakeRoot",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),De=e(re.prototype,"winParticle",[lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ee=e(re.prototype,"lblMyScore",[rt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),He=e(re.prototype,"lblLeftScore",[at],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ze=e(re.prototype,"lblRightScore",[st],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ae=e(re.prototype,"infoLabel",[ot],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Le=e(re.prototype,"resultPanel",[ht],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ge=e(re.prototype,"btnRestart",[ut],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ke=e(re.prototype,"audioSource",[ct],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Oe=e(re.prototype,"panelResultNew",[pt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ie=e(re.prototype,"lblResTitle",[dt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ne=e(re.prototype,"lblResMeRole",[bt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xe=e(re.prototype,"lblResMeScore",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ue=e(re.prototype,"lblResLeftRole",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Fe=e(re.prototype,"lblResLeftScore",[gt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),We=e(re.prototype,"lblResRightRole",[_t],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ve=e(re.prototype,"lblResRightScore",[vt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xe=e(re.prototype,"lblResMultiplier",[mt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ke=e(re.prototype,"btnContinue",[Ct],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ye=e(re.prototype,"panelAbout",[St],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Je=e(re.prototype,"btnCloseAbout",[wt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),je=e(re.prototype,"btnInfo",[Tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qe=e(re.prototype,"panelSettings",[Pt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ze=e(re.prototype,"btnSetting",[Rt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qe=e(re.prototype,"toggleBGM",[Mt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$e=e(re.prototype,"toggleSFX",[Bt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ti=e(re.prototype,"clipBGMNormal",[Dt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ei=e(re.prototype,"clipBGMFast",[Et],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ii=e(re.prototype,"clipClick",[Ht],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ni=e(re.prototype,"clipDeal",[zt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),li=e(re.prototype,"clipWin",[At],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ri=e(re.prototype,"clipLose",[Lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ai=e(re.prototype,"clipAlert1",[Gt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),si=e(re.prototype,"clipAlert2",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oi=e(re.prototype,"clipsCall",[Ot],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),hi=e(re.prototype,"clipsNoCall",[It],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ui=e(re.prototype,"clipsGrab",[Nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ci=e(re.prototype,"clipsNoGrab",[xt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),pi=e(re.prototype,"clipsDouble",[Ut],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),di=e(re.prototype,"clipsNoDouble",[Ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),bi=e(re.prototype,"clipsPlay",[Wt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),fi=e(re.prototype,"clipsPass",[Vt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),yi=e(re.prototype,"clipsDani",[Xt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),gi=e(re.prototype,"clipBomb",[Kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_i=e(re.prototype,"clipRocket",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vi=e(re.prototype,"clipPlane",[Jt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mi=e(re.prototype,"clipStraight",[jt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ci=e(re.prototype,"clipStraightPairs",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Si=e(re.prototype,"clip31",[Zt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wi=e(re.prototype,"clip32",[qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ti=e(re.prototype,"clip4WithOne",[$t],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pi=e(re.prototype,"clip4WithPair",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ri=e(re.prototype,"clipsSingle",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Mi=e(re.prototype,"clipsPair",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Bi=e(re.prototype,"clipsTriple",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),le=re))||le));a._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./Card.ts","./DebugSize.ts","./GameLogic.ts","./GameManager.ts","./OpponentHand.ts","./Player.ts","./PokerAlgo.ts","./SafeArea.ts","./SimpleHandAdapter.ts","./SmartAI.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/OpponentHand.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameLogic.ts","./Card.ts","./SmartAI.ts"],(function(t){var a,r,e,n,i,o,s,l,d,c,u,h,p,f,v,C;return{setters:[function(t){a=t.applyDecoratedDescriptor,r=t.inheritsLoose,e=t.initializerDefineProperty,n=t.assertThisInitialized,i=t.createForOfIteratorHelperLoose},function(t){o=t.cclegacy,s=t._decorator,l=t.Label,d=t.Node,c=t.Prefab,u=t.instantiate,h=t.Component},function(t){p=t.CardType,f=t.GameLogic},function(t){v=t.Card},function(t){C=t.SmartAI}],execute:function(){var b,y,g,m,H,_,L,P,D;o._RF.push({},"ea670SVLvZJ0bSYtMBYXYPh","OpponentHand",void 0);var S=s.ccclass,z=s.property;t("OpponentHand",(b=S("OpponentHand"),y=z({type:l}),g=z({type:d}),m=z({type:c}),b((L=a((_=function(t){function a(){for(var a,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a=t.call.apply(t,[this].concat(i))||this,e(a,"countLabel",L,n(a)),e(a,"cardHolder",P,n(a)),e(a,"cardPrefab",D,n(a)),a._handCards=[],a}r(a,t);var o=a.prototype;return o.setCards=function(t,a){this._handCards=t,this.sortHand(),this.updateDisplay()},o.addCards=function(t){var a;(a=this._handCards).push.apply(a,t),this.sortHand(),this.updateDisplay()},o.getCardCount=function(){return this._handCards.length},o.sortHand=function(){this._handCards.sort((function(t,a){return t.val!==a.val?a.val-t.val:a.suit-t.suit}))},o.updateDisplay=function(){if(this.countLabel&&(this.countLabel.string=this._handCards.length.toString()),this.cardHolder&&this.cardPrefab){this.cardHolder.removeAllChildren();for(var t=Math.min(this._handCards.length,10),a=0;a<t;a++){var r=u(this.cardPrefab);r.parent=this.cardHolder,r.setScale(.5,.5,1),r.setPosition(3*a,0,0);var e=r.getComponent(v);e&&e.showBack()}}},o.startTurn=function(t,a,r){var e=this,n=.5+Math.random();this.scheduleOnce((function(){var n,i=p.Invalid,o=-1;if(t&&t.length>0){var s=f.analyzeCards(t);i=s.type,o=s.val}(n=C.findMove(e._handCards,i,o,a)).length>0?(e.removeCards(n),r(n)):r([])}),n)},o.removeCards=function(t){for(var a,r=[],e=[].concat(t),n=i(this._handCards);!(a=n()).done;){for(var o=a.value,s=-1,l=0;l<e.length;l++)if(e[l].val===o.val&&e[l].suit===o.suit){s=l;break}-1!==s?e.splice(s,1):r.push(o)}this._handCards=r,this.updateDisplay()},a}(h)).prototype,"countLabel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=a(_.prototype,"cardHolder",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=a(_.prototype,"cardPrefab",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=_))||H));o._RF.pop()}}}));

System.register("chunks:///_virtual/Player.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,n,t,i,a,l,o,c,u,s;return{setters:[function(e){r=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,l=e._decorator,o=e.Label,c=e.Sprite,u=e.Node,s=e.Component}],execute:function(){var p,b,f,d,y,g,h,v,L,m,I;a._RF.push({},"55282PreBBI7IhzCn1BgRWe","Player",void 0);var z=l.ccclass,P=l.property;e("Player",(p=z("Player"),b=P(o),f=P(o),d=P(c),y=P(u),p((v=r((h=function(e){function r(){for(var r,n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=e.call.apply(e,[this].concat(a))||this,t(r,"nameLabel",v,i(r)),t(r,"scoreLabel",L,i(r)),t(r,"avatar",m,i(r)),t(r,"landlordIcon",I,i(r)),r}n(r,e);var a=r.prototype;return a.setInfo=function(e,r){this.nameLabel.string=e,this.scoreLabel.string=r.toString()},a.setLandlord=function(e){this.landlordIcon&&(this.landlordIcon.active=e)},r}(s)).prototype,"nameLabel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=r(h.prototype,"scoreLabel",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=r(h.prototype,"avatar",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=r(h.prototype,"landlordIcon",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=h))||g));a._RF.pop()}}}));

System.register("chunks:///_virtual/PokerAlgo.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var e,r;return{setters:[function(n){e=n.createForOfIteratorHelperLoose},function(n){r=n.cclegacy}],execute:function(){r._RF.push({},"6165aN1cJ1OxaqgkBiwYgnl","PokerAlgo",void 0);n("PokerAlgo",function(){function n(){}return n.filterSelectedCards=function(n){if(!n||0==n.length)return[];var e=[].concat(n).sort((function(n,e){return e.val-n.val})),r=this.findBomb(e);if(r.length>0)return r;var t=this.findStraight(e);return t.length>=5?t:n.map((function(n){return n.index}))},n.findBomb=function(n){for(var r,t=new Map,o=e(n);!(r=o()).done;){var u=r.value;t.has(u.val)||t.set(u.val,[]),t.get(u.val).push(u.index)}for(var i,a=e(t.values());!(i=a()).done;){var l=i.value;if(4===l.length)return l}return[]},n.findStraight=function(n){return n.filter((function(n){return n.val<15})).length,[]},n}());r._RF.pop()}}}));

System.register("chunks:///_virtual/SafeArea.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,n,o,a,r,s;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,o=t.view,a=t.Widget,r=t.sys,s=t.Component}],execute:function(){var c;i._RF.push({},"1696715uL5JLbPBfS7xSo2W","SafeArea",void 0);var h=n.ccclass;n.property,t("SafeArea",h("SafeArea")(c=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var n=i.prototype;return n.start=function(){var t=this;this.adapt(),o.setResizeCallback((function(){t.adapt()}))},n.adapt=function(){var t=this.node.getComponent(a);t||(t=this.node.addComponent(a));var e=r.getSafeAreaRect();o.getVisibleSize();console.log("[SafeArea] x:"+e.x+" y:"+e.y+" w:"+e.width+" h:"+e.height),t.isAlignTop=!0,t.isAlignBottom=!0,t.isAlignLeft=!0,t.isAlignRight=!0;var i=o.getVisibleSize();t.left=e.x,t.right=i.width-(e.x+e.width),t.top=i.height-(e.y+e.height),t.bottom=e.y,t.updateAlignment()},i}(s))||c);i._RF.pop()}}}));

System.register("chunks:///_virtual/SimpleHandAdapter.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,a,i,n,r,o,l,p,c,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,i=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){r=e.cclegacy,o=e._decorator,l=e.Layout,p=e.view,c=e.Vec3,u=e.Component}],execute:function(){var s,h,d,g,f,b,y,S,m,w,z,L,v,H,A,R,_,k,x,D;r._RF.push({},"7ff38JakGZJBbsdmQ26x91t","SimpleHandAdapter",void 0);var P=o.ccclass,B=o.property;e("SimpleHandAdapter",(s=P("SimpleHandAdapter"),h=B({type:l,tooltip:"必须拖入 MeHolder 身上挂的 Layout 组件"}),d=B({header:"📱 长屏/全面屏 (Ratio > 1.8)"}),g=B({tooltip:"长屏下缩放倍数 (建议 1.15)"}),f=B({tooltip:"长屏下间距 (建议 -50)"}),b=B({header:"📟 平板/iPad (Ratio < 1.7)"}),y=B({tooltip:"平板下缩放倍数 (建议 0.9)"}),S=B({tooltip:"平板下间距 (建议 -60，挤紧一点)"}),m=B({header:"😐 标准 16:9 (默认)"}),w=B({tooltip:"普通手机缩放倍数 (1.0)"}),z=B({tooltip:"普通手机间距 (-45)"}),s((H=t((v=function(e){function t(){for(var t,a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r))||this,i(t,"targetLayout",H,n(t)),i(t,"phoneScale",A,n(t)),i(t,"phoneSpacing",R,n(t)),i(t,"padScale",_,n(t)),i(t,"padSpacing",k,n(t)),i(t,"normalScale",x,n(t)),i(t,"normalSpacing",D,n(t)),t}a(t,e);var r=t.prototype;return r.start=function(){var e=this;this.adapt(),p.setResizeCallback((function(){return e.scheduleOnce(e.adapt,.1)}))},r.adapt=function(){if(this.targetLayout){var e=p.getVisibleSize(),t=e.width/e.height,a=this.normalScale,i=this.normalSpacing;t>1.8?(a=this.phoneScale,i=this.phoneSpacing):t<1.7&&(a=this.padScale,i=this.padSpacing),this.node.scale.x!==a&&this.node.setScale(new c(a,a,1)),this.targetLayout.spacingX!==i&&(this.targetLayout.spacingX=i,this.targetLayout.updateLayout())}},t}(u)).prototype,"targetLayout",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(v.prototype,"phoneScale",[d,g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1.15}}),R=t(v.prototype,"phoneSpacing",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-50}}),_=t(v.prototype,"padScale",[b,y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.9}}),k=t(v.prototype,"padSpacing",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-60}}),x=t(v.prototype,"normalScale",[m,w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),D=t(v.prototype,"normalSpacing",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-45}}),L=v))||L));r._RF.pop()}}}));

System.register("chunks:///_virtual/SmartAI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameLogic.ts"],(function(e){var t,r,n,a,l;return{setters:[function(e){t=e.createForOfIteratorHelperLoose},function(e){r=e.cclegacy,n=e._decorator},function(e){a=e.CardType,l=e.GameLogic}],execute:function(){var i;r._RF.push({},"61d40OemwVC7ZfkaOkBIAxb","SmartAI",void 0);var u=n.ccclass;e("SmartAI",u("SmartAI")(i=function(){function e(){}return e.findMove=function(e,t,r,n){if(t!==a.Invalid){var i=l.analyzeCards(e);if(i.type!==a.Invalid&&l.canBeat(i,{type:t,val:r,cards:[]}))return e}var u=this.findAllMoves(e,t,r);return 0===u.length?[]:t===a.Invalid?this._decideActiveMove(e,u,n):this._decideFollowMove(e,u,t,r,n)},e._decideActiveMove=function(e,t,r){if(1===t.length&&t[0].length===e.length)return e;if(0===r.myRole&&!r.isLandlordNext&&r.landlordHandCount>2){var n=this._findSmallestMove(t,a.Single);if(n)return n;var l=this._findSmallestMove(t,a.Pair);if(l)return l}for(var i=0,u=[a.Plane,a.PlaneWithOne,a.PlaneWithPair,a.Straight,a.StraightPair,a.TripleWithOne,a.TripleWithPair,a.Triple,a.Pair,a.Single];i<u.length;i++){var o=u[i],h=this._findSmallestMove(t,o);if(h)return h}return t[0]},e._decideFollowMove=function(e,r,n,i,u){for(var o,h=[],s=[],v=t(r);!(o=v()).done;){var g=o.value,f=l.analyzeCards(g).type;f===a.Bomb||f===a.Rocket?s.push(g):h.push(g)}var c=u.myRole===u.lastRole,d=!c;if(c)return u.lastHandCount<=2||i>=10?[]:h.length>0&&u.myHandCount<5?h[0]:[];if(d){if(u.lastHandCount<=2)return h.length>0?h[h.length-1]:s.length>0?s[0]:[];if(0===u.myRole&&u.isLandlordNext&&(n===a.Single||n===a.Pair)&&i<10){var p=h.filter((function(e){return l.analyzeCards(e).val>=10}));if(p.length>0)return p[0];if(s.length>0&&u.myHandCount<10&&Math.random()>.5)return s[0]}if(h.length>0)return h[0];if(s.length>0)return!(n===a.Bomb||n===a.Rocket)&&u.lastHandCount>8?[]:s[0]}return[]},e._findSmallestMove=function(e,r){for(var n,a=t(e);!(n=a()).done;){var i=n.value;if(l.analyzeCards(i).type===r)return i}return null},e.findAllMoves=function(e,r,n){for(var l,i=[],u=[].concat(e).sort((function(e,t){return e.val-t.val})),o=new Map,h=t(u);!(l=h()).done;){var s=l.value;o.has(s.val)||o.set(s.val,[]),o.get(s.val).push(s)}for(var v,g=Array.from(o.keys()).sort((function(e,t){return e-t})),f=new Set,c=[],d=t(g);!(v=d()).done;){var p=v.value;4===o.get(p).length&&(f.add(p),c.push(o.get(p)))}var S=o.has(16)&&o.has(17),_=[];if(S&&(_=[o.get(16)[0],o.get(17)[0]]),!r||r===a.Invalid){var y=g.filter((function(e){return!f.has(e)&&(!S||16!==e&&17!==e)}));i.push.apply(i,this._findPlanes(y,o)),i.push.apply(i,this._findStraights(y,o,5)),i.push.apply(i,this._findStraightPairs(y,o,3));for(var P,m=t(y);!(P=m()).done;){var b=P.value;if(3===o.get(b).length){for(var k,R=t(g);!(k=R()).done;){var T=k.value;if(T!==b&&o.get(T).length<4&&!(S&&T>=16)){i.push([].concat(o.get(b),[o.get(T)[0]]));break}}for(var M,C=t(g);!(M=C()).done;){var A=M.value;if(A!==b&&o.get(A).length>=2&&o.get(A).length<4){i.push([].concat(o.get(b),o.get(A).slice(0,2)));break}}i.push(o.get(b))}}for(var I,H=t(y);!(I=H()).done;){var w=I.value;o.get(w).length>=2&&i.push(o.get(w).slice(0,2))}for(var W,q=t(y);!(W=q()).done;){var B=W.value;i.push([o.get(B)[0]])}return i.push.apply(i,c),S&&i.push(_),i}switch(r){case a.Single:for(var L,O=t(g);!(L=O()).done;){var F=L.value;F>n&&i.push([o.get(F)[0]])}break;case a.Pair:for(var x,z=t(g);!(x=z()).done;){var G=x.value;G>n&&o.get(G).length>=2&&i.push(o.get(G).slice(0,2))}break;case a.Triple:case a.TripleWithOne:case a.TripleWithPair:for(var N,j=t(g);!(N=j()).done;){var V=N.value;if(V>n&&o.get(V).length>=3){var Z=o.get(V).slice(0,3);if(r===a.Triple)i.push(Z);else for(var D,E=r===a.TripleWithPair?2:1,J=t(g);!(D=J()).done;){var K=D.value;if(K!==V&&o.get(K).length>=E){if(f.has(K))continue;if(S&&K>=16)continue;i.push([].concat(Z,o.get(K).slice(0,E)));break}}}}break;case a.Straight:this._findStraights(g,o,5);break;case a.Bomb:for(var Q,U=t(g);!(Q=U()).done;){var X=Q.value;X>n&&4===o.get(X).length&&i.push(o.get(X))}}return r!==a.Rocket&&(i.push.apply(i,c),S&&i.push(_)),i},e._findPlanes=function(e,r){var n=[],a=e.filter((function(e){return e<15&&r.get(e).length>=3}));if(a.length<2)return[];for(var l,i=[],u=t(a);!(l=u()).done;){var o=l.value;0===i.length||o===i[i.length-1]+1?i.push(o):(i.length>=2&&this._buildPlane(i,e,r,n),i=[o])}return i.length>=2&&this._buildPlane(i,e,r,n),n},e._buildPlane=function(e,r,n,a){for(var l,i=[],u=new Set,o=t(e);!(l=o()).done;){var h=l.value;u.add(h),i.push.apply(i,n.get(h).slice(0,3))}for(var s,v=[],g=t(r);!(s=g()).done;){var f=s.value;if(!u.has(f)&&(v.push(n.get(f)[0]),v.length===e.length))break}v.length===e.length&&a.push([].concat(i,v));for(var c,d=[],p=t(r);!(c=p()).done;){var S=c.value;if(!u.has(S)&&n.get(S).length>=2&&(d.push.apply(d,n.get(S).slice(0,2)),d.length===2*e.length))break}d.length===2*e.length&&a.push([].concat(i,d)),a.push(i)},e._findStraights=function(e,r,n){var a=[],l=e.filter((function(e){return e<15}));if(l.length<n)return[];for(var i,u=[],o=t(l);!(i=o()).done;){var h=i.value;0===u.length||h===u[u.length-1]+1?u.push(h):(u.length>=n&&this._pushSeqToResult(u,r,a),u=[h])}return u.length>=n&&this._pushSeqToResult(u,r,a),a},e._pushSeqToResult=function(e,r,n){for(var a,l=[],i=t(e);!(a=i()).done;){var u=a.value;l.push(r.get(u)[0])}n.push(l)},e._findStraightPairs=function(e,r,n){var a=[],l=e.filter((function(e){return e<15&&r.get(e).length>=2}));if(l.length<n)return[];for(var i,u=[],o=t(l);!(i=o()).done;){var h=i.value;0===u.length||h===u[u.length-1]+1?u.push(h):(u.length>=n&&this._pushPairSeqToResult(u,r,a),u=[h])}return u.length>=n&&this._pushPairSeqToResult(u,r,a),a},e._pushPairSeqToResult=function(e,r,n){for(var a,l=[],i=t(e);!(a=i()).done;){var u=a.value;l.push(r.get(u)[0]),l.push(r.get(u)[1])}n.push(l)},e}())||i);r._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});