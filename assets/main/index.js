System.register("chunks:///_virtual/Card.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,e,r,n,s,o,a,l,u,c,p,S,h,m,d;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,r=t.createForOfIteratorHelperLoose,n=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,l=t.Sprite,u=t.SpriteAtlas,c=t.SpriteFrame,p=t.Color,S=t.Vec3,h=t.tween,m=t.UITransform,d=t.Component}],execute:function(){var b,g,f,v,w,y,k,_,F,C,z,B,I;o._RF.push({},"e9ae8MoviNGnbXZ2ussE1Bx","Card",void 0);var A=a.ccclass,H=a.property;t("Card",(b=A("Card"),g=H({type:l,tooltip:"数字 Sprite"}),f=H({type:l,tooltip:"小花色 Sprite (左上角)"}),v=H({type:l,tooltip:"大花色 Sprite (中间图案)"}),w=H({type:u,tooltip:"扑克图集"}),y=H({type:c,tooltip:"【必拖】牌背图片"}),b((F=i((_=function(t){function i(){for(var i,e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return i=t.call.apply(t,[this].concat(r))||this,n(i,"numSprite",F,s(i)),n(i,"smallSuit",C,s(i)),n(i,"bigSuit",z,s(i)),n(i,"pokerAtlas",B,s(i)),n(i,"cardBackFrame",I,s(i)),i.isSelected=!1,i}e(i,t);var o=i.prototype;return o.start=function(){},o.showBack=function(){this.numSprite&&(this.numSprite.node.active=!1),this.smallSuit&&(this.smallSuit.node.active=!1),this.bigSuit&&(this.bigSuit.node.active=!1);var t=this.node.getComponent(l);t&&(t.node.active=!0,t.color=p.WHITE,this.cardBackFrame?t.spriteFrame=this.cardBackFrame:this.setSprite(t,"poker_back"))},o.setCard=function(t,i){if(this.numSprite&&(this.numSprite.node.active=!0),this.smallSuit&&(this.smallSuit.node.active=!0),this.bigSuit&&(this.bigSuit.node.active=!0),this.numSprite&&(this.numSprite.color=p.WHITE),this.smallSuit&&(this.smallSuit.color=p.WHITE),this.bigSuit&&(this.bigSuit.color=p.WHITE),this.setSprite(this.node.getComponent(l),"bg"),t>=13){var e=13==t?"smalltag_4":"smalltag_5";this.setSprite(this.smallSuit,e),this.smallSuit&&(this.smallSuit.node.setScale(new S(.7,.7,1)),this.smallSuit.node.setPosition(new S(-50,38,0)));var r=13==t?"bigtag_4":"bigtag_5";return this.setSprite(this.bigSuit,r),this.bigSuit&&(this.bigSuit.node.setPosition(new S(20,-30,0)),this.bigSuit.node.setScale(new S(.75,.75,1))),void(this.numSprite&&(this.numSprite.node.active=!1))}var n=[2,3,4,5,6,7,8,9,10,11,12,0,1][t],s=0===i||2===i?"red_":"black_";this.setSprite(this.numSprite,s+n);var o="bigtag_"+i;this.setSprite(this.smallSuit,o),this.smallSuit&&this.smallSuit.node.setScale(new S(.4,.4,1)),this.setSprite(this.bigSuit,o),this.bigSuit&&(this.bigSuit.node.setPosition(new S(10,-25,0)),this.bigSuit.node.setScale(new S(.9,.9,1)))},o.setSelectState=function(t,i){if(void 0===i&&(i=!1),this.isSelected!==t){this.isSelected=t;var e=this.isSelected?20:0,r=this.node.position.x;i?this.node.setPosition(new S(r,e,0)):h(this.node).stop().to(.1,{position:new S(r,e,0)}).start()}},o.getWidth=function(){var t=this.node.getComponent(m);return t?t.contentSize.width:0},o.setSprite=function(t,i){if(this.pokerAtlas&&t){for(var e,n=this.pokerAtlas.getSpriteFrames(),s=null,o=r(n);!(e=o()).done;){var a=e.value;if(a.name===i||a.name===i+".png"||a.name.endsWith("/"+i)){s=a;break}}s?(t.spriteFrame=s,t.node.active=!0):"poker_back"!==i||this.cardBackFrame||console.warn("Card: 找不到图片 "+i)}},i}(d)).prototype,"numSprite",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=i(_.prototype,"smallSuit",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=i(_.prototype,"bigSuit",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=i(_.prototype,"pokerAtlas",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=i(_.prototype,"cardBackFrame",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=_))||k));o._RF.pop()}}}));

System.register("chunks:///_virtual/GameLogic.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){var a,e,t;return{setters:[function(r){a=r.createForOfIteratorHelperLoose},function(r){e=r.cclegacy,t=r._decorator}],execute:function(){var i;e._RF.push({},"08963cVuXZFXaSL7RKDAxVE","GameLogic",void 0);var n=t.ccclass,l=r("CardType",function(r){return r[r.Invalid=0]="Invalid",r[r.Single=1]="Single",r[r.Pair=2]="Pair",r[r.Triple=3]="Triple",r[r.TripleWithOne=4]="TripleWithOne",r[r.TripleWithPair=5]="TripleWithPair",r[r.Bomb=6]="Bomb",r[r.Rocket=7]="Rocket",r[r.Straight=8]="Straight",r[r.StraightPairs=9]="StraightPairs",r[r.Plane=10]="Plane",r[r.FourWithOne=11]="FourWithOne",r[r.FourWithPair=12]="FourWithPair",r}({}));r("GameLogic",n("GameLogic")(i=function(){function r(){}return r.toLogicValue=function(r){return 13===r?16:14===r?17:r+3},r.toRawValue=function(r){return 16===r?13:17===r?14:r-3},r.canBeat=function(r,a){return r.type===l.Rocket||a.type!==l.Rocket&&(r.type===l.Bomb?a.type!==l.Bomb||r.val>a.val:a.type!==l.Bomb&&(r.type===a.type&&(r.cards.length===a.cards.length&&r.val>a.val)))},r.analyzeCards=function(r){var e=r.length;if(0===e)return{type:l.Invalid,val:0,cards:[]};r.sort((function(r,a){return a.val-r.val}));for(var t,i=new Map,n=a(r);!(t=n()).done;){var v=t.value;i.set(v.val,(i.get(v.val)||0)+1)}for(var o,u=0,c=0,s=a(i.entries());!(o=s()).done;){var f=o.value,p=f[0],d=f[1];d>u?(u=d,c=p):d===u&&p>c&&(c=p)}var h=r[0];if(1===e)return{type:l.Single,val:h.val,cards:r};if(2===e){if(17===r[0].val&&16===r[1].val)return{type:l.Rocket,val:100,cards:r};if(r[0].val===r[1].val)return{type:l.Pair,val:h.val,cards:r}}if(3===e&&3===u)return{type:l.Triple,val:c,cards:r};if(4===e){if(4===u)return{type:l.Bomb,val:c,cards:r};if(3===u)return{type:l.TripleWithOne,val:c,cards:r}}if(5===e&&3===u&&2===i.size)return{type:l.TripleWithPair,val:c,cards:r};if(6===e){if(4===u)return{type:l.FourWithOne,val:c,cards:r};if(e%2==0&&r[0].val<15&&this._isStraightPairs(r))return{type:l.StraightPairs,val:r[0].val,cards:r}}if(8===e&&4===u){for(var g,y=!0,P=a(i.values());!(g=P()).done;){g.value%2!=0&&(y=!1)}if(y)return{type:l.FourWithPair,val:c,cards:r}}if(e>=5&&1===u&&r[0].val<15&&r[0].val-r[e-1].val==e-1)return{type:l.Straight,val:h.val,cards:r};if(e>=6&&e%2==0&&r[0].val<15&&this._isStraightPairs(r))return{type:l.StraightPairs,val:r[0].val,cards:r};for(var S,W=[],m=a(i.entries());!(S=m()).done;){var F=S.value,T=F[0];F[1]>=3&&T<15&&W.push(T)}W.sort((function(r,a){return a-r}));for(var R=0;R<W.length-1;R++){for(var b=1,B=W[R],L=R+1;L<W.length&&W[L]===W[L-1]-1;L++)b++;if(b>=2){if(e===3*b)return{type:l.Plane,val:B,cards:r};if(e===4*b)return{type:l.Plane,val:B,cards:r};if(e===5*b){for(var k=new Set,O=0;O<b;O++)k.add(B-O);for(var _,I=!0,G=a(i.entries());!(_=G()).done;){var V=_.value,w=V[0],x=V[1];if((k.has(w)?x-3:x)%2!=0){I=!1;break}}if(I)return{type:l.Plane,val:B,cards:r}}}}return{type:l.Invalid,val:0,cards:[]}},r._isStraightPairs=function(r){for(var a=0;a<r.length;a+=2){if(r[a].val!==r[a+1].val)return!1;if(a+2<r.length&&r[a].val!==r[a+2].val+1)return!1}return!0},r}())||i);e._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Card.ts","./GameLogic.ts","./OpponentHand.ts","./SmartAI.ts"],(function(t){var e,i,n,l,r,a,s,o,h,u,c,p,d,b,f,y,g,v,_,m,C,S,w,P,T,R,H;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.createForOfIteratorHelperLoose,l=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){a=t.cclegacy,s=t._decorator,o=t.Prefab,h=t.Node,u=t.ParticleSystem2D,c=t.Label,p=t.AudioSource,d=t.Toggle,b=t.AudioClip,f=t.instantiate,y=t.Vec3,g=t.tween,v=t.Layout,_=t.UITransform,m=t.Color,C=t.Vec2,S=t.Component},function(t){w=t.Card},function(t){P=t.CardType,T=t.GameLogic},function(t){R=t.OpponentHand},function(t){H=t.SmartAI}],execute:function(){var M,B,E,D,z,k,L,G,A,x,I,O,N,U,F,W,V,X,Y,j,Q,q,J,K,Z,$,tt,et,it,nt,lt,rt,at,st,ot,ht,ut,ct,pt,dt,bt,ft,yt,gt,vt,_t,mt,Ct,St,wt,Pt,Tt,Rt,Ht,Mt,Bt,Et,Dt,zt,kt,Lt,Gt,At,xt,It,Ot,Nt,Ut,Ft,Wt,Vt,Xt,Yt,jt,Qt,qt,Jt,Kt,Zt,$t,te,ee,ie,ne,le,re,ae,se,oe,he,ue,ce,pe,de,be,fe,ye,ge,ve,_e,me,Ce,Se,we,Pe,Te,Re,He,Me,Be,Ee,De,ze,ke,Le,Ge,Ae,xe,Ie,Oe,Ne,Ue,Fe,We,Ve,Xe,Ye,je,Qe,qe,Je,Ke,Ze,$e,ti,ei,ii,ni,li,ri,ai,si,oi,hi,ui,ci,pi,di,bi,fi,yi,gi,vi,_i,mi,Ci,Si,wi,Pi,Ti,Ri,Hi,Mi;a._RF.push({},"00e4dQ48bRD0pWoymx8EV95","GameManager",void 0);var Bi=s.ccclass,Ei=s.property,Di=function(t){return t[t.Idle=0]="Idle",t[t.Deal=1]="Deal",t[t.Bid=2]="Bid",t[t.Double=3]="Double",t[t.Play=4]="Play",t[t.Settle=5]="Settle",t}(Di||{});t("GameManager",(M=Bi("GameManager"),B=Ei({type:o}),E=Ei({type:h}),D=Ei({type:h}),z=Ei({type:h}),k=Ei({type:R}),L=Ei({type:R}),G=Ei({type:h}),A=Ei({type:h}),x=Ei({type:h}),I=Ei({type:h}),O=Ei({type:h}),N=Ei({type:h}),U=Ei({type:h}),F=Ei({type:h}),W=Ei({type:h}),V=Ei({type:h}),X=Ei({type:h}),Y=Ei({type:h}),j=Ei({type:h}),Q=Ei({type:h}),q=Ei({type:h}),J=Ei({type:u}),K=Ei({type:c}),Z=Ei({type:c}),$=Ei({type:c}),tt=Ei({type:c}),et=Ei({type:h}),it=Ei({type:c}),nt=Ei({type:h}),lt=Ei({type:p}),rt=Ei({header:"=== V12 结算面板组件 ==="}),at=Ei({type:h}),st=Ei({type:c}),ot=Ei({type:c}),ht=Ei({type:c}),ut=Ei({type:c}),ct=Ei({type:c}),pt=Ei({type:c}),dt=Ei({type:c}),bt=Ei({type:c}),ft=Ei({type:h}),yt=Ei({header:"=== V12 关于与设置 ==="}),gt=Ei({type:h}),vt=Ei({type:h,tooltip:"拖入关于面板里的那个'关闭页面'橙色按钮"}),_t=Ei({type:h}),mt=Ei({type:h}),Ct=Ei({type:h}),St=Ei({type:d}),wt=Ei({type:d}),Pt=Ei({header:"=== 背景音乐 ==="}),Tt=Ei({type:b}),Rt=Ei({type:b}),Ht=Ei({header:"=== 基础音效 ==="}),Mt=Ei({type:b}),Bt=Ei({type:b}),Et=Ei({type:b}),Dt=Ei({type:b}),zt=Ei({type:b}),kt=Ei({type:b}),Lt=Ei({header:"=== 叫分与抢地主 ==="}),Gt=Ei({type:[b]}),At=Ei({type:[b]}),xt=Ei({type:[b]}),It=Ei({type:[b]}),Ot=Ei({type:[b]}),Nt=Ei({type:[b]}),Ut=Ei({header:"=== 出牌语音 ==="}),Ft=Ei({type:[b]}),Wt=Ei({type:[b]}),Vt=Ei({type:[b]}),Xt=Ei({header:"=== 牌型语音 (分离版) ==="}),Yt=Ei({type:b}),jt=Ei({type:b}),Qt=Ei({type:b}),qt=Ei({type:b}),Jt=Ei({type:b}),Kt=Ei({type:b}),Zt=Ei({type:b}),$t=Ei({type:b,tooltip:"拖入 sidaier.ogg"}),te=Ei({type:b,tooltip:"拖入 sidailiangdui.ogg"}),ee=Ei({header:"=== 单张/对子/纯三张 ==="}),ie=Ei({type:[b]}),ne=Ei({type:[b]}),le=Ei({type:[b]}),M((se=e((ae=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,l(e,"cardPrefab",se,r(e)),l(e,"meHolder",oe,r(e)),l(e,"tableHolder",he,r(e)),l(e,"topHoleCardHolder",ue,r(e)),l(e,"leftPlayer",ce,r(e)),l(e,"rightPlayer",pe,r(e)),l(e,"btnPlay",de,r(e)),l(e,"btnPass",be,r(e)),l(e,"btnHint",fe,r(e)),l(e,"panelBid",ye,r(e)),l(e,"groupCall",ge,r(e)),l(e,"groupGrab",ve,r(e)),l(e,"groupDouble",_e,r(e)),l(e,"btnCall",me,r(e)),l(e,"btnNoCall",Ce,r(e)),l(e,"btnGrab",Se,r(e)),l(e,"btnNoGrab",we,r(e)),l(e,"btnDouble",Pe,r(e)),l(e,"btnNoDouble",Te,r(e)),l(e,"iconLandlord",Re,r(e)),l(e,"shakeRoot",He,r(e)),l(e,"winParticle",Me,r(e)),l(e,"lblMyScore",Be,r(e)),l(e,"lblLeftScore",Ee,r(e)),l(e,"lblRightScore",De,r(e)),l(e,"infoLabel",ze,r(e)),l(e,"resultPanel",ke,r(e)),l(e,"resultTitle",Le,r(e)),l(e,"btnRestart",Ge,r(e)),l(e,"audioSource",Ae,r(e)),l(e,"panelResultNew",xe,r(e)),l(e,"lblResTitle",Ie,r(e)),l(e,"lblResMeRole",Oe,r(e)),l(e,"lblResMeScore",Ne,r(e)),l(e,"lblResLeftRole",Ue,r(e)),l(e,"lblResLeftScore",Fe,r(e)),l(e,"lblResRightRole",We,r(e)),l(e,"lblResRightScore",Ve,r(e)),l(e,"lblResMultiplier",Xe,r(e)),l(e,"btnContinue",Ye,r(e)),l(e,"panelAbout",je,r(e)),l(e,"btnCloseAbout",Qe,r(e)),l(e,"btnInfo",qe,r(e)),l(e,"panelSettings",Je,r(e)),l(e,"btnSetting",Ke,r(e)),l(e,"toggleBGM",Ze,r(e)),l(e,"toggleSFX",$e,r(e)),l(e,"clipBGMNormal",ti,r(e)),l(e,"clipBGMFast",ei,r(e)),l(e,"clipClick",ii,r(e)),l(e,"clipDeal",ni,r(e)),l(e,"clipWin",li,r(e)),l(e,"clipLose",ri,r(e)),l(e,"clipAlert1",ai,r(e)),l(e,"clipAlert2",si,r(e)),l(e,"clipsCall",oi,r(e)),l(e,"clipsNoCall",hi,r(e)),l(e,"clipsGrab",ui,r(e)),l(e,"clipsNoGrab",ci,r(e)),l(e,"clipsDouble",pi,r(e)),l(e,"clipsNoDouble",di,r(e)),l(e,"clipsPlay",bi,r(e)),l(e,"clipsPass",fi,r(e)),l(e,"clipsDani",yi,r(e)),l(e,"clipBomb",gi,r(e)),l(e,"clipRocket",vi,r(e)),l(e,"clipPlane",_i,r(e)),l(e,"clipStraight",mi,r(e)),l(e,"clipStraightPairs",Ci,r(e)),l(e,"clip31",Si,r(e)),l(e,"clip32",wi,r(e)),l(e,"clip4WithOne",Pi,r(e)),l(e,"clip4WithPair",Ti,r(e)),l(e,"clipsSingle",Ri,r(e)),l(e,"clipsPair",Hi,r(e)),l(e,"clipsTriple",Mi,r(e)),e._myHand=[],e._myCardScripts=[],e._lastPlayedCards=[],e._currentBoss="",e._landlord="",e._holeCards=[],e._isSliding=!1,e._startIdx=-1,e._currentIdx=-1,e._targetSelectState=!0,e._isActing=!1,e._hintMoves=[],e._hintIndex=0,e._baseScore=100,e._currentMultiple=1,e._scoreMe=1e4,e._scoreLeft=5e3,e._scoreRight=5e3,e._phase=Di.Idle,e._bidTurnIndex=0,e._bidCount=0,e._hasLandlordCandidate=!1,e._landlordCandidate="",e._isFastBGM=!1,e._isBGMOn=!0,e._isSFXOn=!0,e}i(e,t);var a=e.prototype;return a.start=function(){var t,e=this;this.meHolder&&(this.meHolder.on(h.EventType.TOUCH_START,this.onTouchStart,this),this.meHolder.on(h.EventType.TOUCH_MOVE,this.onTouchMove,this),this.meHolder.on(h.EventType.TOUCH_END,this.onTouchEnd,this),this.meHolder.on(h.EventType.TOUCH_CANCEL,this.onTouchEnd,this)),this.btnPlay&&this.btnPlay.on(h.EventType.TOUCH_END,this.onPlayBtnClicked,this),this.btnPass&&this.btnPass.on(h.EventType.TOUCH_END,this.onPassBtnClicked,this),this.btnRestart&&this.btnRestart.on(h.EventType.TOUCH_END,this.initGame,this),this.btnCall&&this.btnCall.on(h.EventType.TOUCH_END,(function(){return e.onUserBtnClick(!0)}),this),this.btnGrab&&this.btnGrab.on(h.EventType.TOUCH_END,(function(){return e.onUserBtnClick(!0)}),this),this.btnDouble&&this.btnDouble.on(h.EventType.TOUCH_END,(function(){return e.onUserBtnClick(!0)}),this),this.btnNoCall&&this.btnNoCall.on(h.EventType.TOUCH_END,(function(){return e.onUserBtnClick(!1)}),this),this.btnNoGrab&&this.btnNoGrab.on(h.EventType.TOUCH_END,(function(){return e.onUserBtnClick(!1)}),this),this.btnNoDouble&&this.btnNoDouble.on(h.EventType.TOUCH_END,(function(){return e.onUserBtnClick(!1)}),this),this.btnHint&&(this.btnHint.off(h.EventType.TOUCH_END),this.btnHint.on(h.EventType.TOUCH_END,this.onHintClicked,this)),this.btnContinue&&this.btnContinue.on(h.EventType.TOUCH_END,this.initGame,this),this.btnInfo&&this.btnInfo.on(h.EventType.TOUCH_END,this.onBtnInfoClick,this),this.btnSetting&&this.btnSetting.on(h.EventType.TOUCH_END,this.onBtnSettingClick,this),this.toggleBGM&&this.toggleBGM.node.on("toggle",this.onAudioSettingsChanged,this),this.toggleSFX&&this.toggleSFX.node.on("toggle",this.onAudioSettingsChanged,this),this.panelAbout&&this.panelAbout.on(h.EventType.TOUCH_END,(function(){e.panelAbout.active=!1}),this),this.btnCloseAbout&&this.btnCloseAbout.on(h.EventType.TOUCH_END,(function(){e.playEffect(e.clipClick),e.panelAbout.active=!1}),this),this.panelSettings&&(null==(t=this.panelSettings.getChildByName("BtnClose"))||t.on(h.EventType.TOUCH_END,(function(){e.panelSettings.active=!1}),this)),this.scheduleOnce((function(){return e.initGame()}),.5)},a.onBtnInfoClick=function(){this.playEffect(this.clipClick),this.panelAbout&&(this.panelAbout.active=!0)},a.onBtnSettingClick=function(){this.playEffect(this.clipClick),this.panelSettings&&(this.panelSettings.active=!0)},a.onAudioSettingsChanged=function(){this.toggleBGM&&(this._isBGMOn=this.toggleBGM.isChecked),this.toggleSFX&&(this._isSFXOn=this.toggleSFX.isChecked),this._isBGMOn?this.audioSource&&!this.audioSource.playing&&this.playBGM(this._isFastBGM):this.audioSource&&this.audioSource.stop()},a.playBGM=function(t){if(this.audioSource&&this._isBGMOn){var e=t?this.clipBGMFast:this.clipBGMNormal;e||(e=this.clipBGMNormal),this.audioSource.clip===e&&this.audioSource.playing||(this.audioSource.stop(),this.audioSource.clip=e,this.audioSource.loop=!0,this.audioSource.play(),this._isFastBGM=t)}},a.checkBGM=function(){if(this._phase===Di.Play){var t=this._myHand.length,e=this.leftPlayer?this.leftPlayer.getCardCount():17,i=this.rightPlayer?this.rightPlayer.getCardCount():17;t<=2||e<=2||i<=2?this.playBGM(!0):this.playBGM(!1)}},a.playEffect=function(t){this.audioSource&&t&&this._isSFXOn&&this.audioSource.playOneShot(t)},a.playRandomEffect=function(t){if(this.audioSource&&t&&0!==t.length&&this._isSFXOn){var e=Math.floor(Math.random()*t.length);t[e]&&this.audioSource.playOneShot(t[e])}},a.playCardSound=function(t,e){if(this.playRandomEffect(this.clipsPlay),!e&&t.type!==P.Bomb&&t.type!==P.Rocket&&Math.random()>.6)this.playRandomEffect(this.clipsDani);else switch(t.type){case P.Single:var i=t.val-3;this.clipsSingle[i]&&this.playEffect(this.clipsSingle[i]);break;case P.Pair:var n=t.val-3;this.clipsPair[n]&&this.playEffect(this.clipsPair[n]);break;case P.Triple:var l=t.val-3;this.clipsTriple[l]?this.playEffect(this.clipsTriple[l]):this.playEffect(this.clip31);break;case P.TripleWithOne:this.playEffect(this.clip31);break;case P.TripleWithPair:this.playEffect(this.clip32);break;case P.Straight:this.playEffect(this.clipStraight);break;case P.StraightPairs:this.playEffect(this.clipStraightPairs);break;case P.Plane:this.playEffect(this.clipPlane);break;case P.Bomb:this.playEffect(this.clipBomb);break;case P.Rocket:this.playEffect(this.clipRocket);break;case P.FourWithOne:this.playEffect(this.clip4WithOne);break;case P.FourWithPair:this.playEffect(this.clip4WithPair)}},a.initGame=function(){var t,e,i,n=this;console.log("游戏重置"),this.unscheduleAllCallbacks(),this._phase=Di.Idle,this.resultPanel&&(this.resultPanel.active=!1),this.panelResultNew&&(this.panelResultNew.active=!1),this.panelBid&&(this.panelBid.active=!1),this.hideAllGroups(),this.iconLandlord&&(this.iconLandlord.active=!1),this.btnHint&&(this.btnHint.active=!1),this.winParticle&&(this.winParticle.stopSystem(),this.winParticle.node.active=!1),null==(t=this.topHoleCardHolder)||t.removeAllChildren(),null==(e=this.meHolder)||e.removeAllChildren(),null==(i=this.tableHolder)||i.removeAllChildren(),this.playBGM(!1),this._isActing=!0,this._currentMultiple=1,this.updateScoreLabels(),this._lastPlayedCards=[],this._currentBoss="",this._landlord="",this._myCardScripts=[],this._hintMoves=[],this._hintIndex=0;for(var l=[],r=0;r<=12;r++)for(var a=0;a<=3;a++)l.push({val:T.toLogicValue(r),suit:a,index:0});l.push({val:16,suit:0,index:0}),l.push({val:17,suit:1,index:0}),l.sort((function(){return Math.random()-.5})),this._holeCards=l.slice(0,3);var s=l.slice(3);this.renderHoleCards(!1),this._myHand=s.slice(0,17),this._myHand.sort((function(t,e){return e.val-t.val})),this.leftPlayer&&this.leftPlayer.setCards(s.slice(17,34),!0),this.rightPlayer&&this.rightPlayer.setCards(s.slice(34,51),!0),this.showDebugTip("正在发牌..."),this._phase=Di.Deal,this.animateDeal(this._myHand,(function(){n.startBiddingLogic()}))},a.hideAllGroups=function(){this.groupCall&&(this.groupCall.active=!1),this.groupGrab&&(this.groupGrab.active=!1),this.groupDouble&&(this.groupDouble.active=!1)},a.startBiddingLogic=function(){this._phase=Di.Bid,this._bidCount=0,this._hasLandlordCandidate=!1,this._landlordCandidate="",this._firstBidder=Math.floor(3*Math.random()),this._bidTurnIndex=this._firstBidder,this.showDebugTip(this.getSeatName(this._bidTurnIndex)+" 开始叫牌"),this.processBidTurn()},a.getSeatName=function(t){return 0===t?"我":1===t?"右家":"左家"},a.processBidTurn=function(){var t=this;this._bidCount>=3?this.finishBidding():0===this._bidTurnIndex?this.showMyBidPanel():this.scheduleOnce((function(){t.aiBidAction()}),1)},a.showMyBidPanel=function(){this.panelBid&&(this.panelBid.active=!0,this.hideAllGroups(),this._phase===Di.Bid?this._hasLandlordCandidate?this.groupGrab&&(this.groupGrab.active=!0):this.groupCall&&(this.groupCall.active=!0):this._phase===Di.Double&&this.groupDouble&&(this.groupDouble.active=!0))},a.onUserBtnClick=function(t){var e=this;this.panelBid.active=!1,this.playEffect(this.clipClick),this._phase===Di.Bid?(t?(this._hasLandlordCandidate?(this.showDebugTip("我方抢地主"),this.playRandomEffect(this.clipsGrab),this._currentMultiple*=2):(this.showDebugTip("我方叫地主"),this.playRandomEffect(this.clipsCall)),this._hasLandlordCandidate=!0,this._landlordCandidate="me"):this._hasLandlordCandidate?(this.showDebugTip("我方不抢"),this.playRandomEffect(this.clipsNoGrab)):(this.showDebugTip("我方不叫"),this.playRandomEffect(this.clipsNoCall)),this.nextBidder()):this._phase===Di.Double&&(t?(this._currentMultiple*=2,this.showDebugTip("我方加倍"),this.playRandomEffect(this.clipsDouble)):(this.showDebugTip("我方不加倍"),this.playRandomEffect(this.clipsNoDouble)),this.scheduleOnce((function(){return e.startGameplay()}),.5))},a.aiBidAction=function(){var t=Math.random()>.5,e=1===this._bidTurnIndex?"right":"left",i="right"===e?"右家":"左家";t?(this._hasLandlordCandidate?(this.showDebugTip(i+" 抢地主"),this.playRandomEffect(this.clipsGrab),this._currentMultiple*=2):(this.showDebugTip(i+" 叫地主"),this.playRandomEffect(this.clipsCall)),this._hasLandlordCandidate=!0,this._landlordCandidate=e):this._hasLandlordCandidate?(this.showDebugTip(i+" 不抢"),this.playRandomEffect(this.clipsNoGrab)):(this.showDebugTip(i+" 不叫"),this.playRandomEffect(this.clipsNoCall)),this.nextBidder()},a.nextBidder=function(){this._bidCount++,this._bidTurnIndex=(this._bidTurnIndex+1)%3,this.processBidTurn()},a.finishBidding=function(){var t=this;if(!this._landlordCandidate)return this.showDebugTip("无人叫地主，重新发牌..."),void this.scheduleOnce((function(){return t.initGame()}),1.5);this.setLandlord(this._landlordCandidate)},a.setLandlord=function(t){var e;(this._landlord=t,this.showDebugTip("地主身份确认："+("me"===t?"我方":t)),this.renderHoleCards(!0),"me"===t)?((e=this._myHand).push.apply(e,this._holeCards),this._myHand.sort((function(t,e){return e.val-t.val})),this.renderMyHand()):"left"===t?this.leftPlayer.addCards(this._holeCards):"right"===t&&this.rightPlayer.addCards(this._holeCards);this.updateLandlordIcon(t),this.startDoublingPhase()},a.startDoublingPhase=function(){this._phase=Di.Double,this.showDebugTip("请选择是否加倍"),this.showMyBidPanel()},a.startGameplay=function(){this._phase=Di.Play,this.checkBGM(),"me"===this._landlord?(this._currentBoss="me",this.startMyTurn()):this.opponentAction(this._landlord)},a.renderHoleCards=function(t){if(this.topHoleCardHolder){this.topHoleCardHolder.removeAllChildren();for(var e=0;e<this._holeCards.length;e++){var i=this._holeCards[e],n=f(this.cardPrefab);n.parent=this.topHoleCardHolder,n.setScale(.4,.4,1),n.setPosition(40*e-40,0,0);var l=n.getComponent(w);l&&(l.setCard(T.toRawValue(i.val),i.suit),t||l.showBack())}}},a.updateLandlordIcon=function(t){if(this.iconLandlord){this.iconLandlord.active=!0;var e=new y(0,0,0);"me"===t&&(e=new y(-426,-46,0)),"left"===t&&(e=new y(-275,278,0)),"right"===t&&(e=new y(580,220,0)),g(this.iconLandlord).to(.5,{position:e,scale:new y(1,1,1)},{easing:"backOut"}).start()}},a.updateScoreLabels=function(){this.lblMyScore&&(this.lblMyScore.string=""+this._scoreMe),this.lblLeftScore&&(this.lblLeftScore.string=""+this._scoreLeft),this.lblRightScore&&(this.lblRightScore.string=""+this._scoreRight)},a.startMyTurn=function(){var t;(this._isActing=!1,this._hintMoves=[],this._hintIndex=0,"me"===this._currentBoss)&&(this._lastPlayedCards=[],null==(t=this.tableHolder)||t.removeAllChildren(),this.showDebugTip("当前轮到我方任意出牌"));this.btnPlay&&(this.btnPlay.active=!0),this.btnPass&&(this.btnPass.active=this._lastPlayedCards.length>0&&"me"!==this._currentBoss),this.btnHint&&(this.btnHint.active=this._lastPlayedCards.length>0&&"me"!==this._currentBoss)},a.animateDeal=function(t,e){var i=this,n=0;this.schedule((function(){if(n>=t.length)e&&e();else{var l=t[n];i.createOneCard(l),i.playEffect(i.clipDeal),n++}}),.04,t.length)},a.createOneCard=function(t){if(this.meHolder){var e=f(this.cardPrefab);e.parent=this.meHolder,e.setPosition(0,0,0),e.setScale(1,1,1);var i=e.getComponent(w);i&&(i.setCard(T.toRawValue(t.val),t.suit),i.setSelectState(!1,!0),this._myCardScripts.push(i))}},a.onHintClicked=function(){if(!this._isActing){if(0===this._hintMoves.length){var t=P.Invalid,e=0;if(this._lastPlayedCards.length>0&&"me"!==this._currentBoss){var i=T.analyzeCards(this._lastPlayedCards);t=i.type,e=i.val}this._hintMoves=H.findAllMoves(this._myHand,t,e),this._hintIndex=0}if(0!==this._hintMoves.length){var l=this._hintMoves[this._hintIndex];this._myCardScripts.forEach((function(t){return t.setSelectState(!1)}));for(var r=0;r<this._myHand.length;r++){for(var a,s=this._myHand[r],o=!1,h=n(l);!(a=h()).done;){var u=a.value;if(u.val===s.val&&u.suit===s.suit){o=!0;break}}o&&this._myCardScripts[r].setSelectState(!0)}this._hintIndex=(this._hintIndex+1)%this._hintMoves.length,this.playEffect(this.clipClick)}else this.showDebugTip("提示：没有可压制的牌型")}},a.onPlayBtnClicked=function(){var t=this;if(!this._isActing){for(var e=[],i=[],l=[],r=0;r<this._myCardScripts.length;r++)this._myCardScripts[r].isSelected&&(e.push(this._myHand[r]),l.push(this._myCardScripts[r].node.worldPosition.clone()));if(0!==e.length){e.sort((function(t,e){return t.val-e.val}));var a=T.analyzeCards(e);if(a.type===P.Invalid){var s=this._tryFixSelection(e);s&&(e=s,a=T.analyzeCards(e))}if(a.type!==P.Invalid){var o="me"===this._currentBoss||0===this._lastPlayedCards.length;if(!o){var h=T.analyzeCards(this._lastPlayedCards);if(!T.canBeat(a,h))return void this.showDebugTip("牌型小于上家，无法出牌")}a.type===P.Bomb&&(this._currentMultiple*=2,this.showDebugTip("炸弹！当前倍数 x"+this._currentMultiple),this.shakeScreen(.5,15)),a.type===P.Rocket&&(this._currentMultiple*=2,this.showDebugTip("王炸！当前倍数 x"+this._currentMultiple),this.shakeScreen(.8,30)),this._isActing=!0,this.playCardSound(a,o),i=[];for(var u,c=[].concat(e),p=n(this._myHand);!(u=p()).done;){for(var d=u.value,b=-1,f=0;f<c.length;f++)if(c[f].val===d.val&&c[f].suit===d.suit){b=f;break}-1!==b?c.splice(b,1):i.push(d)}this._myHand=i,this._lastPlayedCards=e,this._currentBoss="me",this.renderMyHand(),this.animatePlayedCards(e,l),this.btnPlay&&(this.btnPlay.active=!1),this.btnPass&&(this.btnPass.active=!1),this.btnHint&&(this.btnHint.active=!1),2===this._myHand.length?this.playEffect(this.clipAlert2):1===this._myHand.length&&this.playEffect(this.clipAlert1),this.checkBGM(),0!==this._myHand.length?this.scheduleOnce((function(){return t.opponentAction("right")}),1):this.scheduleOnce((function(){return t.showResult(!0)}),1)}else this.showDebugTip("牌型不符合规则")}else this.showDebugTip("请选择要出的牌")}},a.onPassBtnClicked=function(){var t=this;this._isActing||(this.showDebugTip("不出"),this.playRandomEffect(this.clipsPass),this._isActing=!0,this.btnPlay&&(this.btnPlay.active=!1),this.btnPass&&(this.btnPass.active=!1),this.btnHint&&(this.btnHint.active=!1),this.scheduleOnce((function(){return t.opponentAction("right")}),.5))},a.opponentAction=function(t){var e=this,i="right"===t?this.rightPlayer:this.leftPlayer,n="right"===t?"left":"me",l="right"===t?"右边":"左边";if(i){var r;if(this._currentBoss===t)null==(r=this.tableHolder)||r.removeAllChildren();var a=this._currentBoss===t?[]:this._lastPlayedCards;i.startTurn(a,(function(r){if(r.length>0){var a=T.analyzeCards(r);if(e.playCardSound(a,e._currentBoss===t),a.type===P.Bomb&&(e._currentMultiple*=2,e.showDebugTip(l+" 打出炸弹，当前倍数 x"+e._currentMultiple),e.shakeScreen(.5,15)),a.type===P.Rocket&&(e._currentMultiple*=2,e.showDebugTip(l+" 打出王炸，当前倍数 x"+e._currentMultiple),e.shakeScreen(.8,30)),e._lastPlayedCards=r,e._currentBoss=t,e.displayTableCards(r),e.showDebugTip(l+" 出牌"),2===i.getCardCount()?e.playEffect(e.clipAlert2):1===i.getCardCount()&&e.playEffect(e.clipAlert1),e.checkBGM(),0===i.getCardCount())return void e.scheduleOnce((function(){return e.showResult(!1)}),1)}else e.showDebugTip(l+" 不出"),e.playRandomEffect(e.clipsPass);"me"===n?e.startMyTurn():e.opponentAction(n)}))}},a.displayTableCards=function(t){if(this.tableHolder){this.tableHolder.removeAllChildren();var e=this.tableHolder.getComponent(v);e&&(e.enabled=!1);var i=-(35*(t.length-1))/2;t.sort((function(t,e){return e.val-t.val}));for(var n=0;n<t.length;n++){var l=t[n],r=f(this.cardPrefab);r.parent=this.tableHolder,r.setScale(.1,.1,1),r.setPosition(i+35*n,0,0);var a=r.getComponent(w);a&&a.setCard(T.toRawValue(l.val),l.suit),g(r).to(.3,{scale:new y(.5,.5,1)},{easing:"backOut"}).start()}}},a.animatePlayedCards=function(t,e){if(this.tableHolder){this.tableHolder.removeAllChildren();var i=this.tableHolder.getComponent(v);i&&(i.enabled=!1);for(var n=-(35*(t.length-1))/2,l=0;l<t.length;l++){var r=t[l],a=f(this.cardPrefab);if(a.parent=this.tableHolder,a.getComponent(w).setCard(T.toRawValue(r.val),r.suit),e&&e[l]){var s=this.tableHolder.getComponent(_).convertToNodeSpaceAR(e[l]);a.setPosition(s),a.setScale(1,1,1)}else a.setPosition(n+35*l,0,0),a.setScale(.5,.5,1);var o=10*(Math.random()-.5);a.angle=o,g(a).parallel(g().to(.3,{position:new y(n+35*l,0,0)},{easing:"cubicOut"}),g().to(.2,{scale:new y(.6,.6,1)},{easing:"backOut"})).start()}}},a.renderMyHand=function(){var t;null==(t=this.meHolder)||t.removeAllChildren(),this._myCardScripts=[],this._myHand.sort((function(t,e){return e.val-t.val}));for(var e,i=n(this._myHand);!(e=i()).done;){var l=e.value;this.createOneCard(l)}},a.showResult=function(t){this.unscheduleAllCallbacks(),this.audioSource&&this.audioSource.stop(),this.playEffect(t?this.clipWin:this.clipLose),t&&this.winParticle?(this.winParticle.node.active=!0,this.winParticle.resetSystem()):this.winParticle&&(this.winParticle.stopSystem(),this.winParticle.node.active=!1);var e=this._baseScore*this._currentMultiple,i="me"===this._landlord,n=0,l=0,r=0;t?i?(n=2*e,l=-e,r=-e):"left"===this._landlord?(l=2*-e,n=e,r=e):"right"===this._landlord&&(r=2*-e,n=e,l=e):i?(n=2*-e,l=e,r=e):"left"===this._landlord?(l=2*e,n=-e,r=-e):"right"===this._landlord&&(r=2*e,n=-e,l=-e),this._scoreMe+=n,this._scoreLeft+=l,this._scoreRight+=r,this.updateScoreLabels(),this.panelResultNew&&(this.panelResultNew.active=!0,this.lblResTitle&&(this.lblResTitle.string=t?"胜 利":"失 败",this.lblResTitle.color=t?new m(255,215,0):new m(180,180,180)),this.lblResMultiplier&&(this.lblResMultiplier.string="x "+this._currentMultiple),this.lblResMeRole&&(this.lblResMeRole.string="me"===this._landlord?"地主":"农民"),this.lblResMeScore&&(this.lblResMeScore.string=(n>0?"+":"")+n,this.lblResMeScore.color=n>0?m.YELLOW:m.WHITE),this.lblResLeftRole&&(this.lblResLeftRole.string="left"===this._landlord?"地主":"农民"),this.lblResLeftScore&&(this.lblResLeftScore.string=(l>0?"+":"")+l,this.lblResLeftScore.color=l>0?m.YELLOW:m.WHITE),this.lblResRightRole&&(this.lblResRightRole.string="right"===this._landlord?"地主":"农民"),this.lblResRightScore&&(this.lblResRightScore.string=(r>0?"+":"")+r,this.lblResRightScore.color=r>0?m.YELLOW:m.WHITE))},a.showDebugTip=function(t){this.infoLabel&&(this.infoLabel.string=t,this.infoLabel.node.active=!0,this.unschedule(this.hideTip),this.scheduleOnce(this.hideTip,2))},a.hideTip=function(){this.infoLabel&&this.infoLabel.isValid&&(this.infoLabel.node.active=!1)},a.onTouchStart=function(t){if(this._phase!==Di.Deal&&this._phase!==Di.Settle){var e=this.getCardIndexByPos(t.getUILocation());-1!==e?(this.playEffect(this.clipClick),this._isSliding=!0,this._startIdx=e,this._currentIdx=e,this._targetSelectState=!this._myCardScripts[e].isSelected,this.updateSelectionVisual()):this._myCardScripts.forEach((function(t){return t.setSelectState(!1)}))}},a.shakeScreen=function(t,e){void 0===e&&(e=20);var i=this.shakeRoot||this.node,n=i.position.clone();g(i).to(.05,{position:new y(n.x+e,n.y+e,0)}).to(.05,{position:new y(n.x-e,n.y-e,0)}).to(.05,{position:new y(n.x+.8*e,n.y-.8*e,0)}).to(.05,{position:new y(n.x-.8*e,n.y+.8*e,0)}).to(.05,{position:n}).start()},a.onTouchMove=function(t){if(this._isSliding){var e=this.getCardIndexByPos(t.getUILocation());-1!==e&&e!==this._currentIdx&&(this._currentIdx=e,this.updateSelectionVisual())}},a.onTouchEnd=function(t){this._isSliding=!1,this._targetSelectState&&this._smartCorrectSelection()},a._smartCorrectSelection=function(){var t=this;if(-1!==this._startIdx&&-1!==this._currentIdx){var e=Math.min(this._startIdx,this._currentIdx),i=Math.max(this._startIdx,this._currentIdx);if(e!==i){for(var l=[],r=e;r<=i;r++)l.push({index:r,val:this._myHand[r].val});var a=l.map((function(e){return t._myHand[e.index]}));if(a.sort((function(t,e){return t.val-e.val})),T.analyzeCards(a).type===P.Invalid){l.sort((function(t,e){return t.val-e.val}));var s=[],o=this._scanForStraight(l),h=this._scanForPairs(l);if(h.length>=6&&h.length>s.length&&(s=h),o.length>=5&&o.length>s.length&&(s=o),s.length>0){for(var u=e;u<=i;u++)this._myCardScripts[u].setSelectState(!1);for(var c,p=n(s);!(c=p()).done;){var d=c.value;this._myCardScripts[d].setSelectState(!0)}}else for(var b=e;b<=i;b++)this._myCardScripts[b].setSelectState(!0)}else for(var f=e;f<=i;f++)this._myCardScripts[f].setSelectState(!0)}}},a._scanForStraight=function(t){if(t.length<5)return[];var e=t.filter((function(t){return t.val<15}));if(e.length<5)return[];for(var i,l=new Map,r=n(e);!(i=r()).done;){var a=i.value;l.has(a.val)||l.set(a.val,[]),l.get(a.val).push(a.index)}for(var s=Array.from(l.keys()).sort((function(t,e){return t-e})),o=[],h=[],u=0;u<s.length;u++){var c=s[u];0===h.length||c===h[h.length-1]+1?h.push(c):(h.length>o.length&&(o=[].concat(h)),h=[c])}if(h.length>o.length&&(o=[].concat(h)),o.length>=5){for(var p,d=[],b=n(o);!(p=b()).done;){var f=p.value;d.push(l.get(f)[0])}return d}return[]},a._scanForPairs=function(t){var e=t.filter((function(t){return t.val<15}));if(e.length<6)return[];for(var i,l=new Map,r=n(e);!(i=r()).done;){var a=i.value;l.has(a.val)||l.set(a.val,[]),l.get(a.val).push(a.index)}var s=Array.from(l.keys()).filter((function(t){return l.get(t).length>=2})).sort((function(t,e){return t-e}));if(s.length<3)return[];for(var o,h=[],u=[],c=n(s);!(o=c()).done;){var p=o.value;0===u.length||p===u[u.length-1]+1?u.push(p):(u.length>h.length&&(h=[].concat(u)),u=[p])}if(u.length>h.length&&(h=[].concat(u)),h.length>=3){for(var d,b=[],f=n(h);!(d=f()).done;){var y=d.value;b.push(l.get(y)[0]),b.push(l.get(y)[1])}return b}return[]},a._tryFixSelection=function(t){for(var e,i=new Map,l=n(t);!(e=l()).done;){var r=e.value;i.has(r.val)||i.set(r.val,[]),i.get(r.val).push(r)}var a=Array.from(i.keys()).sort((function(t,e){return t-e}));if(a.length<3)return null;for(var s,o=[],h=n(a);!(s=h()).done;){var u=s.value,c=i.get(u);if(c.length<2)return null;o.push(c[0]),o.push(c[1])}return o.sort((function(t,e){return t.val-e.val})),T.analyzeCards(o).type!==P.Invalid?o:null},a.updateSelectionVisual=function(){for(var t=Math.min(this._startIdx,this._currentIdx),e=Math.max(this._startIdx,this._currentIdx),i=t;i<=e;i++)this._myCardScripts[i]&&this._myCardScripts[i].setSelectState(this._targetSelectState)},a.getCardIndexByPos=function(t){var e;if(null==(e=this.meHolder)||!e.getComponent(_))return-1;for(var i=this.meHolder.getComponent(_).convertToNodeSpaceAR(new y(t.x,t.y,0)),n=this._myCardScripts.length-1;n>=0;n--)if(this._myCardScripts[n].node.getComponent(_).getBoundingBox().contains(new C(i.x,i.y)))return n;return-1},e}(S)).prototype,"cardPrefab",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oe=e(ae.prototype,"meHolder",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),he=e(ae.prototype,"tableHolder",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ue=e(ae.prototype,"topHoleCardHolder",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=e(ae.prototype,"leftPlayer",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pe=e(ae.prototype,"rightPlayer",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),de=e(ae.prototype,"btnPlay",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),be=e(ae.prototype,"btnPass",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fe=e(ae.prototype,"btnHint",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ye=e(ae.prototype,"panelBid",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ge=e(ae.prototype,"groupCall",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ve=e(ae.prototype,"groupGrab",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_e=e(ae.prototype,"groupDouble",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),me=e(ae.prototype,"btnCall",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ce=e(ae.prototype,"btnNoCall",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Se=e(ae.prototype,"btnGrab",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),we=e(ae.prototype,"btnNoGrab",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pe=e(ae.prototype,"btnDouble",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Te=e(ae.prototype,"btnNoDouble",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Re=e(ae.prototype,"iconLandlord",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),He=e(ae.prototype,"shakeRoot",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Me=e(ae.prototype,"winParticle",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Be=e(ae.prototype,"lblMyScore",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ee=e(ae.prototype,"lblLeftScore",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),De=e(ae.prototype,"lblRightScore",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ze=e(ae.prototype,"infoLabel",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ke=e(ae.prototype,"resultPanel",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Le=e(ae.prototype,"resultTitle",[it],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ge=e(ae.prototype,"btnRestart",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ae=e(ae.prototype,"audioSource",[lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xe=e(ae.prototype,"panelResultNew",[rt,at],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ie=e(ae.prototype,"lblResTitle",[st],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Oe=e(ae.prototype,"lblResMeRole",[ot],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ne=e(ae.prototype,"lblResMeScore",[ht],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ue=e(ae.prototype,"lblResLeftRole",[ut],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Fe=e(ae.prototype,"lblResLeftScore",[ct],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),We=e(ae.prototype,"lblResRightRole",[pt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ve=e(ae.prototype,"lblResRightScore",[dt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xe=e(ae.prototype,"lblResMultiplier",[bt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ye=e(ae.prototype,"btnContinue",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),je=e(ae.prototype,"panelAbout",[yt,gt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qe=e(ae.prototype,"btnCloseAbout",[vt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qe=e(ae.prototype,"btnInfo",[_t],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Je=e(ae.prototype,"panelSettings",[mt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ke=e(ae.prototype,"btnSetting",[Ct],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ze=e(ae.prototype,"toggleBGM",[St],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$e=e(ae.prototype,"toggleSFX",[wt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ti=e(ae.prototype,"clipBGMNormal",[Pt,Tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ei=e(ae.prototype,"clipBGMFast",[Rt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ii=e(ae.prototype,"clipClick",[Ht,Mt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ni=e(ae.prototype,"clipDeal",[Bt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),li=e(ae.prototype,"clipWin",[Et],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ri=e(ae.prototype,"clipLose",[Dt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ai=e(ae.prototype,"clipAlert1",[zt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),si=e(ae.prototype,"clipAlert2",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oi=e(ae.prototype,"clipsCall",[Lt,Gt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),hi=e(ae.prototype,"clipsNoCall",[At],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ui=e(ae.prototype,"clipsGrab",[xt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ci=e(ae.prototype,"clipsNoGrab",[It],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),pi=e(ae.prototype,"clipsDouble",[Ot],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),di=e(ae.prototype,"clipsNoDouble",[Nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),bi=e(ae.prototype,"clipsPlay",[Ut,Ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),fi=e(ae.prototype,"clipsPass",[Wt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),yi=e(ae.prototype,"clipsDani",[Vt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),gi=e(ae.prototype,"clipBomb",[Xt,Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vi=e(ae.prototype,"clipRocket",[jt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_i=e(ae.prototype,"clipPlane",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mi=e(ae.prototype,"clipStraight",[qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ci=e(ae.prototype,"clipStraightPairs",[Jt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Si=e(ae.prototype,"clip31",[Kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wi=e(ae.prototype,"clip32",[Zt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pi=e(ae.prototype,"clip4WithOne",[$t],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ti=e(ae.prototype,"clip4WithPair",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ri=e(ae.prototype,"clipsSingle",[ee,ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Hi=e(ae.prototype,"clipsPair",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Mi=e(ae.prototype,"clipsTriple",[le],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),re=ae))||re));a._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./Card.ts","./GameLogic.ts","./GameManager.ts","./OpponentHand.ts","./Player.ts","./PokerAlgo.ts","./SmartAI.ts"],(function(){return{setters:[null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/OpponentHand.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameLogic.ts","./Card.ts","./SmartAI.ts"],(function(t){var e,a,r,n,i,o,s,d,l,u,c,h,p,f,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,a=t.inheritsLoose,r=t.createForOfIteratorHelperLoose,n=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){o=t.cclegacy,s=t._decorator,d=t.Label,l=t.Node,u=t.Prefab,c=t.instantiate,h=t.Component},function(t){p=t.GameLogic},function(t){f=t.Card},function(t){v=t.SmartAI}],execute:function(){var g,C,y,b,_,m,H,L,P;o._RF.push({},"ea670SVLvZJ0bSYtMBYXYPh","OpponentHand",void 0);var D=s.ccclass,S=s.property;t("OpponentHand",(g=D("OpponentHand"),C=S({type:d}),y=S({type:l}),b=S({type:u}),g((H=e((m=function(t){function e(){for(var e,a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,n(e,"countLabel",H,i(e)),n(e,"cardHolder",L,i(e)),n(e,"cardPrefab",P,i(e)),e._handCards=[],e}a(e,t);var o=e.prototype;return o.setCards=function(t,e){this._handCards=t,this.sortHand(),this.updateDisplay()},o.addCards=function(t){var e;(e=this._handCards).push.apply(e,t),this.sortHand(),this.updateDisplay()},o.getCardCount=function(){return this._handCards.length},o.sortHand=function(){this._handCards.sort((function(t,e){return t.val!==e.val?e.val-t.val:e.suit-t.suit}))},o.updateDisplay=function(){if(this.countLabel&&(this.countLabel.string=this._handCards.length.toString()),this.cardHolder&&this.cardPrefab){this.cardHolder.removeAllChildren();for(var t=Math.min(this._handCards.length,10),e=0;e<t;e++){var a=c(this.cardPrefab);a.parent=this.cardHolder,a.setScale(.5,.5,1),a.setPosition(3*e,0,0);var r=a.getComponent(f);r&&r.showBack()}}},o.startTurn=function(t,e){var a=this,r=.5+Math.random();this.scheduleOnce((function(){var r=[];if(t&&0!==t.length){var n=p.analyzeCards(t);r=v.findMove(a._handCards,n.type,n.val)}else r=a.decideBestLead();r.length>0?(a.removeCards(r),e(r)):e([])}),r)},o.decideBestLead=function(){if(0===this._handCards.length)return[];for(var t,e=new Map,a=r(this._handCards);!(t=a()).done;){var n=t.value;e.has(n.val)||e.set(n.val,[]),e.get(n.val).push(n)}for(var i,o=Array.from(e.keys()).sort((function(t,e){return t-e})),s=r(o);!(i=s()).done;){var d=i.value,l=e.get(d);if(3===l.length){for(var u,c=r(o);!(u=c()).done;){var h=u.value,p=e.get(h);if(h!==d&&1===p.length)return[].concat(l,[p[0]])}return l}}for(var f,v=r(o);!(f=v()).done;){var g=f.value,C=e.get(g);if(2===C.length)return C}return[this._handCards[this._handCards.length-1]]},o.removeCards=function(t){for(var e,a=[],n=[].concat(t),i=r(this._handCards);!(e=i()).done;){for(var o=e.value,s=-1,d=0;d<n.length;d++)if(n[d].val===o.val&&n[d].suit===o.suit){s=d;break}-1!==s?n.splice(s,1):a.push(o)}this._handCards=a,this.updateDisplay()},e}(h)).prototype,"countLabel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(m.prototype,"cardHolder",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(m.prototype,"cardPrefab",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=m))||_));o._RF.pop()}}}));

System.register("chunks:///_virtual/Player.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,n,t,i,a,l,o,c,u,s;return{setters:[function(e){r=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,l=e._decorator,o=e.Label,c=e.Sprite,u=e.Node,s=e.Component}],execute:function(){var p,b,f,d,y,g,h,v,L,m,I;a._RF.push({},"55282PreBBI7IhzCn1BgRWe","Player",void 0);var z=l.ccclass,P=l.property;e("Player",(p=z("Player"),b=P(o),f=P(o),d=P(c),y=P(u),p((v=r((h=function(e){function r(){for(var r,n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=e.call.apply(e,[this].concat(a))||this,t(r,"nameLabel",v,i(r)),t(r,"scoreLabel",L,i(r)),t(r,"avatar",m,i(r)),t(r,"landlordIcon",I,i(r)),r}n(r,e);var a=r.prototype;return a.setInfo=function(e,r){this.nameLabel.string=e,this.scoreLabel.string=r.toString()},a.setLandlord=function(e){this.landlordIcon&&(this.landlordIcon.active=e)},r}(s)).prototype,"nameLabel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=r(h.prototype,"scoreLabel",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=r(h.prototype,"avatar",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=r(h.prototype,"landlordIcon",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=h))||g));a._RF.pop()}}}));

System.register("chunks:///_virtual/PokerAlgo.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var e,r;return{setters:[function(n){e=n.createForOfIteratorHelperLoose},function(n){r=n.cclegacy}],execute:function(){r._RF.push({},"6165aN1cJ1OxaqgkBiwYgnl","PokerAlgo",void 0);n("PokerAlgo",function(){function n(){}return n.filterSelectedCards=function(n){if(!n||0==n.length)return[];var e=[].concat(n).sort((function(n,e){return e.val-n.val})),r=this.findBomb(e);if(r.length>0)return r;var t=this.findStraight(e);return t.length>=5?t:n.map((function(n){return n.index}))},n.findBomb=function(n){for(var r,t=new Map,o=e(n);!(r=o()).done;){var u=r.value;t.has(u.val)||t.set(u.val,[]),t.get(u.val).push(u.index)}for(var i,a=e(t.values());!(i=a()).done;){var l=i.value;if(4===l.length)return l}return[]},n.findStraight=function(n){return n.filter((function(n){return n.val<15})).length,[]},n}());r._RF.pop()}}}));

System.register("chunks:///_virtual/SmartAI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameLogic.ts"],(function(e){var t,r,n,a,l;return{setters:[function(e){t=e.createForOfIteratorHelperLoose},function(e){r=e.cclegacy,n=e._decorator},function(e){a=e.CardType,l=e.GameLogic}],execute:function(){var u;r._RF.push({},"61d40OemwVC7ZfkaOkBIAxb","SmartAI",void 0);var i=n.ccclass;e("SmartAI",i("SmartAI")(u=function(){function e(){}return e.findMove=function(e,t,r){if(t!==a.Invalid){var n=l.analyzeCards(e);if(n.type!==a.Invalid&&l.canBeat(n,{type:t,val:r,cards:[]}))return e}else{if(l.analyzeCards(e).type!==a.Invalid)return e}var u=this.findAllMoves(e,t,r);if(0===u.length)return[];var i=u.filter((function(e){var t=l.analyzeCards(e);return t.type!==a.Bomb&&t.type!==a.Rocket}));return t!==a.Bomb&&t!==a.Rocket&&i.length>0?i[0]:u[0]},e.findAllMoves=function(e,r,n){for(var l,u=[],i=[].concat(e).sort((function(e,t){return e.val-t.val})),h=new Map,s=t(i);!(l=s()).done;){var o=l.value;h.has(o.val)||h.set(o.val,[]),h.get(o.val).push(o)}for(var v,g=Array.from(h.keys()).sort((function(e,t){return e-t})),f=[],c=t(g);!(v=c()).done;){var p=v.value;4===h.get(p).length&&f.push(h.get(p))}if(!r||r===a.Invalid){var d=this._findPlanes(g,h);if(d.length>0)return d;var _=this._findStraights(g,h,5);if(_.length>0)return _;var S=this._findStraightPairs(g,h,3);if(S.length>0)return S;for(var y,b=t(g);!(y=b()).done;){var k=y.value;if(3===h.get(k).length){for(var P,m=t(g);!(P=m()).done;){var R=P.value;if(R!==k&&1===h.get(R).length){u.push(h.get(k).concat(h.get(R)[0]));break}}return 0===u.length&&u.push(h.get(k)),u}}for(var T,I=t(g);!(T=I()).done;){var A=T.value;if(2===h.get(A).length)return u.push(h.get(A)),u}return i.length>0&&u.push([i[0]]),u}switch(r){case a.Single:for(var q,B=t(g);!(q=B()).done;){var C=q.value;C>n&&u.push([h.get(C)[0]])}break;case a.Pair:for(var M,w=t(g);!(M=w()).done;){var L=M.value;L>n&&h.get(L).length>=2&&u.push(h.get(L).slice(0,2))}break;case a.Triple:case a.TripleWithOne:case a.TripleWithPair:for(var O,z=t(g);!(O=z()).done;){var F=O.value,x=h.get(F);if(F>n&&x.length>=3){var G=x.slice(0,3);if(r===a.Triple)u.push(G);else for(var H,W=t(g);!(H=W()).done;){var j=H.value;if(j!==F&&h.get(j).length>=1){u.push(G.concat(h.get(j)[0]));break}}}}break;case a.Bomb:for(var V,Z=t(g);!(V=Z()).done;){var D=V.value;D>n&&4===h.get(D).length&&u.push(h.get(D))}}return r!==a.Rocket&&(u.push.apply(u,f),h.has(16)&&h.has(17)&&u.push([h.get(16)[0],h.get(17)[0]])),u},e._findPlanes=function(e,t){var r=[],n=e.filter((function(e){return e<15&&t.get(e).length>=3}));if(n.length<2)return[];for(var a=[],l=0;l<n.length;l++){var u=n[l];0===a.length||u===a[a.length-1]+1?a.push(u):(a.length>=2&&this._buildPlane(a,e,t,r),a=[u])}return a.length>=2&&this._buildPlane(a,e,t,r),r},e._buildPlane=function(e,r,n,a){for(var l,u=[],i=new Set,h=t(e);!(l=h()).done;){var s=l.value;i.add(s),u.push.apply(u,n.get(s).slice(0,3))}for(var o,v=[],g=e.length,f=t(r);!(o=f()).done;){var c=o.value;if(!i.has(c)&&(v.push(n.get(c)[0]),v.length===g))break}v.length===g?a.push(u.concat(v)):a.push(u)},e._findStraights=function(e,t,r){var n=[],a=e.filter((function(e){return e<15}));if(a.length<r)return[];for(var l=[],u=0;u<a.length;u++){var i=a[u];0===l.length||i===l[l.length-1]+1?l.push(i):(l.length>=r&&this._pushSeqToResult(l,t,n),l=[i])}return l.length>=r&&this._pushSeqToResult(l,t,n),n},e._pushSeqToResult=function(e,r,n){for(var a,l=[],u=t(e);!(a=u()).done;){var i=a.value;l.push(r.get(i)[0])}n.push(l)},e._findStraightPairs=function(e,t,r){var n=[],a=e.filter((function(e){return e<15&&t.get(e).length>=2}));if(a.length<r)return[];for(var l=[],u=0;u<a.length;u++){var i=a[u];0===l.length||i===l[l.length-1]+1?l.push(i):(l.length>=r&&this._pushPairSeqToResult(l,t,n),l=[i])}return l.length>=r&&this._pushPairSeqToResult(l,t,n),n},e._pushPairSeqToResult=function(e,r,n){for(var a,l=[],u=t(e);!(a=u()).done;){var i=a.value;l.push(r.get(i)[0]),l.push(r.get(i)[1])}n.push(l)},e}())||u);r._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});